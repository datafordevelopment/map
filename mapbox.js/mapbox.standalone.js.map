{"version":3,"file":"bundle.js","sources":["node_modules/browserify/node_modules/browser-pack/_prelude.js","package.json","src/mapbox.js","src/grid_control.js","src/geocoder_control.js","src/legend_control.js","src/feature_layer.js","src/share_control.js","src/tile_layer.js","src/info_control.js","src/map.js","src/grid_layer.js","src/geocoder.js","src/marker.js","src/simplestyle.js","src/config.js","src/feedback.js","src/util.js","src/url.js","src/request.js","src/load_tilejson.js","src/mapbox_logo.js","src/grid.js","node_modules/sanitize-caja/index.js","node_modules/mustache/mustache.js","node_modules/sanitize-caja/sanitizer-bundle.js","node_modules/corslite/corslite.js"],"names":["geocoderControl","require","gridControl","featureLayer","legendControl","shareControl","tileLayer","infoControl","map","gridLayer","L","mapbox","module","exports","VERSION","version","geocoder","marker","simplestyle","TileLayer","InfoControl","ShareControl","LegendControl","GeocoderControl","GridControl","GridLayer","FeatureLayer","Map","config","sanitize","template","to_html","feedback","window","Icon","Default","imagePath","document","location","protocol","util","Mustache","Control","extend","options","pinnable","follow","sanitizer","touchTeaser","_currentContent","_pinned","initialize","_","Util","setOptions","this","strict_instance","Class","_layer","setTemplate","strict","_template","format","data","getTileJSON","d","_show","content","o","_popup","setContent","setLatLng","latLng","_map","openOn","_container","style","display","_contentWrapper","innerHTML","hide","closePopup","DomUtil","removeClass","_mouseover","addClass","_mousemove","_navigateTo","url","top","href","_click","location_formatted","search","Browser","touch","_onPopupClose","_createClosebutton","container","fn","link","create","title","DomEvent","on","stopPropagation","preventDefault","onAdd","className","contentWrapper","appendChild","Popup","autoPan","closeOnClick","disableClickPropagation","addListener","onRemove","off","includes","Mixin","Events","position","pointZoom","keepOpen","autocomplete","setURL","_updateSubmit","bind","_updateAutocomplete","_chooseResult","accessToken","getURL","setID","setTileJSON","_toggle","e","stop","hasClass","_results","_input","blur","focus","select","_closeIfOpen","results","wrap","form","input","type","setAttribute","_geocode","_autocomplete","_form","err","resp","fire","error","features","length","feature","_displayResults","i","l","Math","min","name","place_name","r","text","outof","result","bbox","fitBounds","lbounds","center","setView","undefined","getZoom","max","value","query","_legends","_update","addLegend","removeLegend","hasOwnProperty","div","urlhelper","request","FeatureGroup","filter","popupOptions","closeButton","_layers","idUrl","setGeoJSON","_geojson","clearLayers","_initialize","getGeoJSON","loadURL","_request","abort","json","log","loadID","id","setFilter","getFilter","len","isArray","geometries","geometry","opts","pointToLayer","latlon","layer","GeoJSON","geometryToLayer","popupHtml","createPopup","setStyle","bindPopup","addLayer","_loadTileJSON","_setTileJSON","_tilejson","_modal","_mask","_content","_shareClick","_clickOut","_sharing","tilejson","encodeURIComponent","webpage","image","getCenter","lng","lat","embed","twitter","facebook","pinterest","share","replace","embedValue","embedLabel","label","close","target","formats","scalePrefix","prototype","call","strict_oneof","setFormat","redraw","setUrl","tiles","attribution","minZoom","minzoom","maxZoom","maxzoom","tms","scheme","bounds","getTileUrl","tilePoint","index","floor","abs","x","y","templated","retina","_info","console","warn","_showInfo","getAttribution","addInfo","_onLayerAdd","_onLayerRemove","removeInfo","_active","_hidecontent","info","push","join","withAccessToken","mapboxLogoControl","LMap","element","attributionControl","setPrefix","compact","offsetWidth","addControl","_mapboxLogoControl","_updateMapFeedbackLink","whenReady","_updateLayer","legend","_loaded","zoom","_controlContainer","getElementsByClassName","hash","toFixed","key","_onLayerReady","setTimeout","addAttribution","stamp","_zoomBoundLayers","_updateZoomLevels","grid","_mouseOn","_cache","grids","active","addTo","_move","getData","latlng","callback","point","project","tileSize","resolution","crs","scale","_getTile","gridX","gridY","_getTileURL","urls","getPixelBounds","z","tileBounds","divideBy","_floor","_tileShouldBeLoaded","callbacks","nwPoint","multiplyBy","sePoint","add","Point","nw","unproject","se","LatLngBounds","intersects","indexOf","queryURL","parts","record","geocoding","res","reverseQuery","normalize","lon","q","pts","icon","fp","sizes","small","medium","large","size","symbol","color","iconUrl","charAt","iconSize","iconAnchor","popupAnchor","f","properties","strip_tags","popup","description","fallback","a","b","c","k","remap","mapping","defaults","stroke","stroke-width","stroke-opacity","fill","fill-opacity","HTTP_URL","HTTPS_URL","FORCE_HTTPS","REQUIRE_ACCESS_TOKEN","Feedback","contains","item","list","t","Error","klass","values","path","tileJSON","urlOrMapID","corslite","onload","JSON","parse","responseText","match","XMLHttpRequest","MapboxLogoControl","mapbox_logo","utfDecode","idx","charCodeAt","keys","cleanUrl","test","getScheme","toString","getPath","cleanId","html_sanitize","root","factory","mustache","define","amd","testRegExp","re","string","RegExp_test","isWhitespace","nonSpaceRe","isFunction","object","escapeRegExp","escapeHtml","String","s","entityMap","Scanner","tail","pos","Context","view","parent",".","Writer","clearCache","renderTokens","tokens","writer","context","subRender","render","token","tokenValue","buffer","lookup","j","jlen","slice","getPartial","escape","nestTokens","tree","collector","sections","section","pop","squashTokens","lastToken","squashedTokens","escapeTags","tags","RegExp","parseTemplate","stripSpace","hasTag","nonSpace","spaces","split","spaceRe","start","chr","openSection","tagRes","scanner","eos","scanUntil","scan","tagRe","whiteRe","eqRe","curlyRe","Object_toString","Object","Array","&","<",">","\"","'","/","substring","make","names","_partialCache","compile","compileTokens","compilePartial","_loadPartial","self","partials","defaultWriter","send","URI","uriStr","m","URI_RE_","nullIfAbsent","credentials","domain","port","fragment","uri","encodeIfExists2","URI_DISALLOWED_IN_SCHEME_OR_CREDENTIALS_","encodeIfExists","URI_DISALLOWED_IN_PATH_","setRawQuery","encodeOne","setAllParameters","unescapedPart","extra","encodeURI","ch","n","normPath","collapse_dots","p","PARENT_DIRECTORY_HANDLER_RE","resolve","baseUri","relativeUri","absoluteUri","clone","overridden","hasScheme","setRawScheme","getRawScheme","hasCredentials","setRawCredentials","getRawCredentials","hasDomain","setRawDomain","getRawDomain","hasPort","rawPath","getRawPath","simplifiedPath","setPort","getPort","EXTRA_PARENT_PATHS_RE","absRawPath","slash","lastIndexOf","setRawPath","hasQuery","getRawQuery","hasFragment","setRawFragment","getRawFragment","rawScheme","rawCredentials","rawDomain","rawQuery","rawFragment","scheme_","credentials_","domain_","port_","path_","query_","fragment_","paramCache_","matchPart","PARENT_DIRECTORY_HANDLER","out","decodeURIComponent","toLowerCase","setScheme","newScheme","getCredentials","setCredentials","newCredentials","getDomain","setDomain","newDomain","newPort","Number","setPath","newPath","hasPath","getQuery","setQuery","newQuery","params","newParams","v","queryBuf","separator","checkParameterCache_","cgiParams","setParameterValues","newValueIndex","pc","removeParameter","getAllParameters","getParameterValues","paramNameUnescaped","getParameterMap","paramMap","getParameterValue","getFragment","setFragment","newFragment","utils","mimeTypeOf","uriObj","base","html4","atype","NONE","URI_FRAGMENT","SCRIPT","STYLE","HTML","ID","IDREF","IDREFS","GLOBAL_NAME","LOCAL_NAME","CLASSES","FRAME_TARGET","MEDIA_QUERY","ATTRIBS","*::class","*::dir","*::draggable","*::hidden","*::id","*::inert","*::itemprop","*::itemref","*::itemscope","*::lang","*::onblur","*::onchange","*::onclick","*::ondblclick","*::onfocus","*::onkeydown","*::onkeypress","*::onkeyup","*::onload","*::onmousedown","*::onmousemove","*::onmouseout","*::onmouseover","*::onmouseup","*::onreset","*::onscroll","*::onselect","*::onsubmit","*::onunload","*::spellcheck","*::style","*::title","*::translate","a::accesskey","a::coords","a::href","a::hreflang","a::name","a::onblur","a::onfocus","a::shape","a::tabindex","a::target","a::type","area::accesskey","area::alt","area::coords","area::href","area::nohref","area::onblur","area::onfocus","area::shape","area::tabindex","area::target","audio::controls","audio::loop","audio::mediagroup","audio::muted","audio::preload","bdo::dir","blockquote::cite","br::clear","button::accesskey","button::disabled","button::name","button::onblur","button::onfocus","button::tabindex","button::type","button::value","canvas::height","canvas::width","caption::align","col::align","col::char","col::charoff","col::span","col::valign","col::width","colgroup::align","colgroup::char","colgroup::charoff","colgroup::span","colgroup::valign","colgroup::width","command::checked","command::command","command::disabled","command::icon","command::label","command::radiogroup","command::type","data::value","del::cite","del::datetime","details::open","dir::compact","div::align","dl::compact","fieldset::disabled","font::color","font::face","font::size","form::accept","form::action","form::autocomplete","form::enctype","form::method","form::name","form::novalidate","form::onreset","form::onsubmit","form::target","h1::align","h2::align","h3::align","h4::align","h5::align","h6::align","hr::align","hr::noshade","hr::size","hr::width","iframe::align","iframe::frameborder","iframe::height","iframe::marginheight","iframe::marginwidth","iframe::width","img::align","img::alt","img::border","img::height","img::hspace","img::ismap","img::name","img::src","img::usemap","img::vspace","img::width","input::accept","input::accesskey","input::align","input::alt","input::autocomplete","input::checked","input::disabled","input::inputmode","input::ismap","input::list","input::max","input::maxlength","input::min","input::multiple","input::name","input::onblur","input::onchange","input::onfocus","input::onselect","input::placeholder","input::readonly","input::required","input::size","input::src","input::step","input::tabindex","input::type","input::usemap","input::value","ins::cite","ins::datetime","label::accesskey","label::for","label::onblur","label::onfocus","legend::accesskey","legend::align","li::type","li::value","map::name","menu::compact","menu::label","menu::type","meter::high","meter::low","meter::max","meter::min","meter::value","ol::compact","ol::reversed","ol::start","ol::type","optgroup::disabled","optgroup::label","option::disabled","option::label","option::selected","option::value","output::for","output::name","p::align","pre::width","progress::max","progress::min","progress::value","q::cite","select::autocomplete","select::disabled","select::multiple","select::name","select::onblur","select::onchange","select::onfocus","select::required","select::size","select::tabindex","source::type","table::align","table::bgcolor","table::border","table::cellpadding","table::cellspacing","table::frame","table::rules","table::summary","table::width","tbody::align","tbody::char","tbody::charoff","tbody::valign","td::abbr","td::align","td::axis","td::bgcolor","td::char","td::charoff","td::colspan","td::headers","td::height","td::nowrap","td::rowspan","td::scope","td::valign","td::width","textarea::accesskey","textarea::autocomplete","textarea::cols","textarea::disabled","textarea::inputmode","textarea::name","textarea::onblur","textarea::onchange","textarea::onfocus","textarea::onselect","textarea::placeholder","textarea::readonly","textarea::required","textarea::rows","textarea::tabindex","textarea::wrap","tfoot::align","tfoot::char","tfoot::charoff","tfoot::valign","th::abbr","th::align","th::axis","th::bgcolor","th::char","th::charoff","th::colspan","th::headers","th::height","th::nowrap","th::rowspan","th::scope","th::valign","th::width","thead::align","thead::char","thead::charoff","thead::valign","tr::align","tr::bgcolor","tr::char","tr::charoff","tr::valign","track::default","track::kind","track::label","track::srclang","ul::compact","ul::type","video::controls","video::height","video::loop","video::mediagroup","video::muted","video::poster","video::preload","video::width","eflags","OPTIONAL_ENDTAG","EMPTY","CDATA","RCDATA","UNSAFE","FOLDABLE","VIRTUALIZED","ELEMENTS","abbr","acronym","address","applet","area","article","aside","audio","basefont","bdi","bdo","big","blockquote","body","br","button","canvas","caption","cite","code","col","colgroup","command","datalist","dd","del","details","dfn","dialog","dir","dl","dt","em","fieldset","figcaption","figure","font","footer","frame","frameset","h1","h2","h3","h4","h5","h6","head","header","hgroup","hr","html","iframe","img","ins","isindex","kbd","keygen","li","mark","menu","meta","meter","nav","nobr","noembed","noframes","noscript","ol","optgroup","option","output","param","pre","progress","samp","script","source","span","strike","strong","sub","summary","sup","table","tbody","td","textarea","tfoot","th","thead","time","tr","track","tt","u","ul","var","video","wbr","ELEMENT_DOM_INTERFACES","ueffects","NOT_LOADED","SAME_DOCUMENT","NEW_DOCUMENT","URIEFFECTS","ltypes","UNSANDBOXED","SANDBOXED","DATA","LOADERTYPES","lookupEntity","ENTITIES","decimalEscapeRe","fromCharCode","parseInt","hexEscapeRe","entityLookupElement","safeEntityNameRe","textContent","decodeOneEntity","stripNULs","nulRe","unescapeEntities","ENTITY_RE_1","escapeAttrib","ampRe","ltRe","gtRe","quotRe","normalizeRCData","rcdata","looseAmpRe","makeSaxParser","handler","hcopy","cdata","comment","endDoc","endTag","pcdata","startDoc","startTag","htmlText","htmlSplit","state","noMoreGT","noMoreEndComments","parseCPS","continuationMaker","h","initial","tagName","end","current","next","ENTITY_RE_2","continuationMarker","exec","parseEndTag","EFLAGS_TEXT","tag","parseText","parseStartTag","substr","str","splitWillCapture","lastPos","parseTagAndAttrs","attrs","endTagRe","first","buf","ATTR_RE","quote","sawQuote","abuf","aName","aValue","decodeValue","makeHtmlSanitizer","tagPolicy","stack","ignoring","emit","tagNameOrig","attribs","eflagsOrig","decision","eflagsRep","tagNameRep","onStack","orig","rep","attribName","stackElOrigTag","stackElRepTag","safeUri","effect","ltype","hints","naiveUriRewriter","parsed","ALLOWED_URI_SCHEMES","safe","logger","oldValue","newValue","change","changed","lookupAttribute","attribKey","getLoaderType","getUriEffect","sanitizeAttribs","opt_naiveUriRewriter","opt_nmTokenPolicy","opt_logger","parseCssDeclarations","sanitizedDeclarations","declaration","property","normProp","schema","cssSchema","sanitizeCssProperty","TYPE","CSS_PROP","XML_ATTR","XML_TAG","makeTagPolicy","sanitizeWithPolicy","inputHtml","outputArray","lt","LT","gt","GT","amp","AMP","quot","apos","nbsp","createElement","cors","isSuccessful","status","loaded","sent","XDomainRequest","original","apply","arguments","that","args","onreadystatechange","readyState","onerror","evt","onprogress","ontimeout","onabort","open"],"mappings":"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","sourcesContent":["(function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a=typeof require==\"function\"&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);var f=new Error(\"Cannot find module '\"+o+\"'\");throw f.code=\"MODULE_NOT_FOUND\",f}var l=n[o]={exports:{}};t[o][0].call(l.exports,function(e){var n=t[o][1][e];return s(n?n:e)},l,l.exports,e,t,n,r)}return n[o].exports}var i=typeof require==\"function\"&&require;for(var o=0;o<r.length;o++)s(r[o]);return s})","module.exports={\"author\":\"Mapbox\",\"name\":\"mapbox.js\",\"description\":\"mapbox javascript api\",\"version\":\"2.1.5\",\"homepage\":\"http://mapbox.com/\",\"repository\":{\"type\":\"git\",\"url\":\"git://github.com/mapbox/mapbox.js.git\"},\"main\":\"src/index.js\",\"dependencies\":{\"leaflet\":\"0.7.3\",\"mustache\":\"0.7.3\",\"corslite\":\"0.0.6\",\"sanitize-caja\":\"0.1.2\"},\"scripts\":{\"test\":\"jshint src/*.js && mocha-phantomjs test/index.html\"},\"devDependencies\":{\"browserify\":\"^6.3.2\",\"clean-css\":\"~2.0.7\",\"expect.js\":\"0.3.1\",\"happen\":\"0.1.3\",\"jshint\":\"2.4.4\",\"leaflet-fullscreen\":\"0.0.4\",\"leaflet-hash\":\"0.2.1\",\"marked\":\"~0.3.0\",\"minifyify\":\"^6.1.0\",\"minimist\":\"0.0.5\",\"mocha\":\"1.17.1\",\"mocha-phantomjs\":\"3.1.6\",\"sinon\":\"1.10.2\"},\"optionalDependencies\":{},\"engines\":{\"node\":\"*\"}}","'use strict';\n\nvar geocoderControl = require('./geocoder_control'),\n    gridControl = require('./grid_control'),\n    featureLayer = require('./feature_layer'),\n    legendControl = require('./legend_control'),\n    shareControl = require('./share_control'),\n    tileLayer = require('./tile_layer'),\n    infoControl = require('./info_control'),\n    map = require('./map'),\n    gridLayer = require('./grid_layer');\n\nL.mapbox = module.exports = {\n    VERSION: require('../package.json').version,\n    geocoder: require('./geocoder'),\n    marker: require('./marker'),\n    simplestyle: require('./simplestyle'),\n    tileLayer: tileLayer.tileLayer,\n    TileLayer: tileLayer.TileLayer,\n    infoControl: infoControl.infoControl,\n    InfoControl: infoControl.InfoControl,\n    shareControl: shareControl.shareControl,\n    ShareControl: shareControl.ShareControl,\n    legendControl: legendControl.legendControl,\n    LegendControl: legendControl.LegendControl,\n    geocoderControl: geocoderControl.geocoderControl,\n    GeocoderControl: geocoderControl.GeocoderControl,\n    gridControl: gridControl.gridControl,\n    GridControl: gridControl.GridControl,\n    gridLayer: gridLayer.gridLayer,\n    GridLayer: gridLayer.GridLayer,\n    featureLayer: featureLayer.featureLayer,\n    FeatureLayer: featureLayer.FeatureLayer,\n    map: map.map,\n    Map: map.Map,\n    config: require('./config'),\n    sanitize: require('sanitize-caja'),\n    template: require('mustache').to_html,\n    feedback: require('./feedback')\n};\n\n\n// Hardcode image path, because Leaflet's autodetection\n// fails, because mapbox.js is not named leaflet.js\nwindow.L.Icon.Default.imagePath =\n    // Detect bad-news protocols like file:// and hardcode\n    // to https if they're detected.\n    ((document.location.protocol == 'https:' ||\n    document.location.protocol == 'http:') ? '' : 'https:') +\n    '//api.tiles.mapbox.com/mapbox.js/' + 'v' +\n    require('../package.json').version + '/images';\n","'use strict';\n\nvar util = require('./util'),\n    Mustache = require('mustache');\n\nvar GridControl = L.Control.extend({\n\n    options: {\n        pinnable: true,\n        follow: false,\n        sanitizer: require('sanitize-caja'),\n        touchTeaser: true,\n        location: true\n    },\n\n    _currentContent: '',\n\n    // pinned means that this control is on a feature and the user has likely\n    // clicked. pinned will not become false unless the user clicks off\n    // of the feature onto another or clicks x\n    _pinned: false,\n\n    initialize: function(_, options) {\n        L.Util.setOptions(this, options);\n        util.strict_instance(_, L.Class, 'L.mapbox.gridLayer');\n        this._layer = _;\n    },\n\n    setTemplate: function(template) {\n        util.strict(template, 'string');\n        this.options.template = template;\n        return this;\n    },\n\n    _template: function(format, data) {\n        if (!data) return;\n        var template = this.options.template || this._layer.getTileJSON().template;\n        if (template) {\n            var d = {};\n            d['__' + format + '__'] = true;\n            return this.options.sanitizer(\n                Mustache.to_html(template, L.extend(d, data)));\n        }\n    },\n\n    // change the content of the tooltip HTML if it has changed, otherwise\n    // noop\n    _show: function(content, o) {\n        if (content === this._currentContent) return;\n\n        this._currentContent = content;\n\n        if (this.options.follow) {\n            this._popup.setContent(content)\n                .setLatLng(o.latLng);\n            if (this._map._popup !== this._popup) this._popup.openOn(this._map);\n        } else {\n            this._container.style.display = 'block';\n            this._contentWrapper.innerHTML = content;\n        }\n    },\n\n    hide: function() {\n        this._pinned = false;\n        this._currentContent = '';\n\n        this._map.closePopup();\n        this._container.style.display = 'none';\n        this._contentWrapper.innerHTML = '';\n\n        L.DomUtil.removeClass(this._container, 'closable');\n\n        return this;\n    },\n\n    _mouseover: function(o) {\n        if (o.data) {\n            L.DomUtil.addClass(this._map._container, 'map-clickable');\n        } else {\n            L.DomUtil.removeClass(this._map._container, 'map-clickable');\n        }\n\n        if (this._pinned) return;\n\n        var content = this._template('teaser', o.data);\n        if (content) {\n            this._show(content, o);\n        } else {\n            this.hide();\n        }\n    },\n\n    _mousemove: function(o) {\n        if (this._pinned) return;\n        if (!this.options.follow) return;\n\n        this._popup.setLatLng(o.latLng);\n    },\n\n    _navigateTo: function(url) {\n        window.top.location.href = url;\n    },\n\n    _click: function(o) {\n\n        var location_formatted = this._template('location', o.data);\n        if (this.options.location && location_formatted &&\n            location_formatted.search(/^https?:/) === 0) {\n            return this._navigateTo(this._template('location', o.data));\n        }\n\n        if (!this.options.pinnable) return;\n\n        var content = this._template('full', o.data);\n\n        if (!content && this.options.touchTeaser && L.Browser.touch) {\n            content = this._template('teaser', o.data);\n        }\n\n        if (content) {\n            L.DomUtil.addClass(this._container, 'closable');\n            this._pinned = true;\n            this._show(content, o);\n        } else if (this._pinned) {\n            L.DomUtil.removeClass(this._container, 'closable');\n            this._pinned = false;\n            this.hide();\n        }\n    },\n\n    _onPopupClose: function() {\n        this._currentContent = null;\n        this._pinned = false;\n    },\n\n    _createClosebutton: function(container, fn) {\n        var link = L.DomUtil.create('a', 'close', container);\n\n        link.innerHTML = 'close';\n        link.href = '#';\n        link.title = 'close';\n\n        L.DomEvent\n            .on(link, 'click', L.DomEvent.stopPropagation)\n            .on(link, 'mousedown', L.DomEvent.stopPropagation)\n            .on(link, 'dblclick', L.DomEvent.stopPropagation)\n            .on(link, 'click', L.DomEvent.preventDefault)\n            .on(link, 'click', fn, this);\n\n        return link;\n    },\n\n    onAdd: function(map) {\n        this._map = map;\n\n        var className = 'leaflet-control-grid map-tooltip',\n            container = L.DomUtil.create('div', className),\n            contentWrapper = L.DomUtil.create('div', 'map-tooltip-content');\n\n        // hide the container element initially\n        container.style.display = 'none';\n        this._createClosebutton(container, this.hide);\n        container.appendChild(contentWrapper);\n\n        this._contentWrapper = contentWrapper;\n        this._popup = new L.Popup({ autoPan: false, closeOnClick: false });\n\n        map.on('popupclose', this._onPopupClose, this);\n\n        L.DomEvent\n            .disableClickPropagation(container)\n            // allow people to scroll tooltips with mousewheel\n            .addListener(container, 'mousewheel', L.DomEvent.stopPropagation);\n\n        this._layer\n            .on('mouseover', this._mouseover, this)\n            .on('mousemove', this._mousemove, this)\n            .on('click', this._click, this);\n\n        return container;\n    },\n\n    onRemove: function (map) {\n\n        map.off('popupclose', this._onPopupClose, this);\n\n        this._layer\n            .off('mouseover', this._mouseover, this)\n            .off('mousemove', this._mousemove, this)\n            .off('click', this._click, this);\n    }\n});\n\nmodule.exports.GridControl = GridControl;\n\nmodule.exports.gridControl = function(_, options) {\n    return new GridControl(_, options);\n};\n","'use strict';\n\nvar geocoder = require('./geocoder'),\n    util = require('./util');\n\nvar GeocoderControl = L.Control.extend({\n    includes: L.Mixin.Events,\n\n    options: {\n        position: 'topleft',\n        pointZoom: 16,\n        keepOpen: false,\n        autocomplete: false\n    },\n\n    initialize: function(_, options) {\n        L.Util.setOptions(this, options);\n        this.setURL(_);\n        this._updateSubmit = L.bind(this._updateSubmit, this);\n        this._updateAutocomplete = L.bind(this._updateAutocomplete, this);\n        this._chooseResult = L.bind(this._chooseResult, this);\n    },\n\n    setURL: function(_) {\n        this.geocoder = geocoder(_, {accessToken: this.options.accessToken});\n        return this;\n    },\n\n    getURL: function() {\n        return this.geocoder.getURL();\n    },\n\n    setID: function(_) {\n        return this.setURL(_);\n    },\n\n    setTileJSON: function(_) {\n        return this.setURL(_.geocoder);\n    },\n\n    _toggle: function(e) {\n        if (e) L.DomEvent.stop(e);\n        if (L.DomUtil.hasClass(this._container, 'active')) {\n            L.DomUtil.removeClass(this._container, 'active');\n            this._results.innerHTML = '';\n            this._input.blur();\n        } else {\n            L.DomUtil.addClass(this._container, 'active');\n            this._input.focus();\n            this._input.select();\n        }\n    },\n\n    _closeIfOpen: function(e) {\n        if (L.DomUtil.hasClass(this._container, 'active') &&\n            !this.options.keepOpen) {\n            L.DomUtil.removeClass(this._container, 'active');\n            this._results.innerHTML = '';\n            this._input.blur();\n        }\n    },\n\n    onAdd: function(map) {\n\n        var container = L.DomUtil.create('div', 'leaflet-control-mapbox-geocoder leaflet-bar leaflet-control'),\n            link = L.DomUtil.create('a', 'leaflet-control-mapbox-geocoder-toggle mapbox-icon mapbox-icon-geocoder', container),\n            results = L.DomUtil.create('div', 'leaflet-control-mapbox-geocoder-results', container),\n            wrap = L.DomUtil.create('div', 'leaflet-control-mapbox-geocoder-wrap', container),\n            form = L.DomUtil.create('form', 'leaflet-control-mapbox-geocoder-form', wrap),\n            input  = L.DomUtil.create('input', '', form);\n\n        link.href = '#';\n        link.innerHTML = '&nbsp;';\n\n        input.type = 'text';\n        input.setAttribute('placeholder', 'Search');\n\n        L.DomEvent.addListener(form, 'submit', this._geocode, this);\n        L.DomEvent.addListener(input, 'keyup', this._autocomplete, this);\n        L.DomEvent.disableClickPropagation(container);\n\n        this._map = map;\n        this._results = results;\n        this._input = input;\n        this._form = form;\n\n        if (this.options.keepOpen) {\n            L.DomUtil.addClass(container, 'active');\n        } else {\n            this._map.on('click', this._closeIfOpen, this);\n            L.DomEvent.addListener(link, 'click', this._toggle, this);\n        }\n\n        return container;\n    },\n\n    _updateSubmit: function(err, resp) {\n        L.DomUtil.removeClass(this._container, 'searching');\n        this._results.innerHTML = '';\n        if (err || !resp) {\n            this.fire('error', {error: err});\n        } else {\n            var features = [];\n            if (resp.results && resp.results.features) {\n                features = resp.results.features;\n            }\n            if (features.length === 1) {\n                this.fire('autoselect', { feature: features[0] });\n                this.fire('found', {results: resp.results});\n                this._chooseResult(features[0]);\n                this._closeIfOpen();\n            } else if (features.length > 1) {\n                this.fire('found', {results: resp.results});\n                this._displayResults(features);\n            } else {\n                this._displayResults(features);\n            }\n        }\n    },\n\n    _updateAutocomplete: function(err, resp) {\n        this._results.innerHTML = '';\n        if (err || !resp) {\n            this.fire('error', {error: err});\n        } else {\n            var features = [];\n            if (resp.results && resp.results.features) {\n                features = resp.results.features;\n            }\n            if (features.length) {\n                this.fire('found', {results: resp.results});\n            }\n            this._displayResults(features);\n        }\n    },\n\n    _displayResults: function(features) {\n        for (var i = 0, l = Math.min(features.length, 5); i < l; i++) {\n            var feature = features[i];\n            var name = feature.place_name;\n            if (!name.length) continue;\n\n            var r = L.DomUtil.create('a', '', this._results);\n            var text = ('innerText' in r) ? 'innerText' : 'textContent';\n            r[text] = name;\n            r.href = '#';\n\n            (L.bind(function(feature) {\n                L.DomEvent.addListener(r, 'click', function(e) {\n                    this._chooseResult(feature);\n                    L.DomEvent.stop(e);\n                    this.fire('select', { feature: feature });\n                }, this);\n            }, this))(feature);\n        }\n        if (features.length > 5) {\n            var outof = L.DomUtil.create('span', '', this._results);\n            outof.innerHTML = 'Top 5 of ' + features.length + '  results';\n        }\n    },\n\n    _chooseResult: function(result) {\n        if (result.bbox) {\n            this._map.fitBounds(util.lbounds(result.bbox));\n        } else if (result.center) {\n            this._map.setView([result.center[1], result.center[0]], (this._map.getZoom() === undefined) ?\n                this.options.pointZoom :\n                Math.max(this._map.getZoom(), this.options.pointZoom));\n        }\n    },\n\n    _geocode: function(e) {\n        L.DomEvent.preventDefault(e);\n        if (this._input.value === '') return this._updateSubmit();\n        L.DomUtil.addClass(this._container, 'searching');\n        this.geocoder.query(this._input.value, this._updateSubmit);\n    },\n\n    _autocomplete: function(e) {\n        if (!this.options.autocomplete) return;\n        if (this._input.value === '') return this._updateAutocomplete();\n        this.geocoder.query(this._input.value, this._updateAutocomplete);\n    }\n});\n\nmodule.exports.GeocoderControl = GeocoderControl;\n\nmodule.exports.geocoderControl = function(_, options) {\n    return new GeocoderControl(_, options);\n};\n","'use strict';\n\nvar LegendControl = L.Control.extend({\n\n    options: {\n        position: 'bottomright',\n        sanitizer: require('sanitize-caja')\n    },\n\n    initialize: function(options) {\n        L.setOptions(this, options);\n        this._legends = {};\n    },\n\n    onAdd: function(map) {\n        this._container = L.DomUtil.create('div', 'map-legends wax-legends');\n        L.DomEvent.disableClickPropagation(this._container);\n\n        this._update();\n\n        return this._container;\n    },\n\n    addLegend: function(text) {\n        if (!text) { return this; }\n\n        if (!this._legends[text]) {\n            this._legends[text] = 0;\n        }\n\n        this._legends[text]++;\n        return this._update();\n    },\n\n    removeLegend: function(text) {\n        if (!text) { return this; }\n        if (this._legends[text]) this._legends[text]--;\n        return this._update();\n    },\n\n    _update: function() {\n        if (!this._map) { return this; }\n\n        this._container.innerHTML = '';\n        var hide = 'none';\n\n        for (var i in this._legends) {\n            if (this._legends.hasOwnProperty(i) && this._legends[i]) {\n                var div = L.DomUtil.create('div', 'map-legend wax-legend', this._container);\n                div.innerHTML = this.options.sanitizer(i);\n                hide = 'block';\n            }\n        }\n\n        // hide the control entirely unless there is at least one legend;\n        // otherwise there will be a small grey blemish on the map.\n        this._container.style.display = hide;\n\n        return this;\n    }\n});\n\nmodule.exports.LegendControl = LegendControl;\n\nmodule.exports.legendControl = function(options) {\n    return new LegendControl(options);\n};\n","'use strict';\n\nvar util = require('./util'),\n    urlhelper = require('./url'),\n    request = require('./request'),\n    marker = require('./marker'),\n    simplestyle = require('./simplestyle');\n\n// # featureLayer\n//\n// A layer of features, loaded from Mapbox or else. Adds the ability\n// to reset features, filter them, and load them from a GeoJSON URL.\nvar FeatureLayer = L.FeatureGroup.extend({\n    options: {\n        filter: function() { return true; },\n        sanitizer: require('sanitize-caja'),\n        style: simplestyle.style,\n        popupOptions: { closeButton: false }\n    },\n\n    initialize: function(_, options) {\n        L.setOptions(this, options);\n\n        this._layers = {};\n\n        if (typeof _ === 'string') {\n            util.idUrl(_, this);\n        // javascript object of TileJSON data\n        } else if (_ && typeof _ === 'object') {\n            this.setGeoJSON(_);\n        }\n    },\n\n    setGeoJSON: function(_) {\n        this._geojson = _;\n        this.clearLayers();\n        this._initialize(_);\n        return this;\n    },\n\n    getGeoJSON: function() {\n        return this._geojson;\n    },\n\n    loadURL: function(url) {\n        if (this._request && 'abort' in this._request) this._request.abort();\n        this._request = request(url, L.bind(function(err, json) {\n            this._request = null;\n            if (err && err.type !== 'abort') {\n                util.log('could not load features at ' + url);\n                this.fire('error', {error: err});\n            } else if (json) {\n                this.setGeoJSON(json);\n                this.fire('ready');\n            }\n        }, this));\n        return this;\n    },\n\n    loadID: function(id) {\n        return this.loadURL(urlhelper('/' + id + '/features.json', this.options.accessToken));\n    },\n\n    setFilter: function(_) {\n        this.options.filter = _;\n        if (this._geojson) {\n            this.clearLayers();\n            this._initialize(this._geojson);\n        }\n        return this;\n    },\n\n    getFilter: function() {\n        return this.options.filter;\n    },\n\n    _initialize: function(json) {\n        var features = L.Util.isArray(json) ? json : json.features,\n            i, len;\n\n        if (features) {\n            for (i = 0, len = features.length; i < len; i++) {\n                // Only add this if geometry or geometries are set and not null\n                if (features[i].geometries || features[i].geometry || features[i].features) {\n                    this._initialize(features[i]);\n                }\n            }\n        } else if (this.options.filter(json)) {\n\n            var opts = {accessToken: this.options.accessToken},\n                pointToLayer = this.options.pointToLayer || function(feature, latlon) {\n                  return marker.style(feature, latlon, opts);\n                },\n                layer = L.GeoJSON.geometryToLayer(json, pointToLayer),\n                popupHtml = marker.createPopup(json, this.options.sanitizer);\n\n            if ('setStyle' in layer) {\n                layer.setStyle(simplestyle.style(json));\n            }\n\n            layer.feature = json;\n\n            if (popupHtml) {\n                layer.bindPopup(popupHtml, this.options.popupOptions);\n            }\n\n            this.addLayer(layer);\n        }\n    }\n});\n\nmodule.exports.FeatureLayer = FeatureLayer;\n\nmodule.exports.featureLayer = function(_, options) {\n    return new FeatureLayer(_, options);\n};\n","'use strict';\n\nvar urlhelper = require('./url');\n\nvar ShareControl = L.Control.extend({\n    includes: [require('./load_tilejson')],\n\n    options: {\n        position: 'topleft',\n        url: ''\n    },\n\n    initialize: function(_, options) {\n        L.setOptions(this, options);\n        this._loadTileJSON(_);\n    },\n\n    _setTileJSON: function(json) {\n        this._tilejson = json;\n    },\n\n    onAdd: function(map) {\n        this._map = map;\n\n        var container = L.DomUtil.create('div', 'leaflet-control-mapbox-share leaflet-bar');\n        var link = L.DomUtil.create('a', 'mapbox-share mapbox-icon mapbox-icon-share', container);\n        link.href = '#';\n\n        this._modal = L.DomUtil.create('div', 'mapbox-modal', this._map._container);\n        this._mask = L.DomUtil.create('div', 'mapbox-modal-mask', this._modal);\n        this._content = L.DomUtil.create('div', 'mapbox-modal-content', this._modal);\n\n        L.DomEvent.addListener(link, 'click', this._shareClick, this);\n        L.DomEvent.disableClickPropagation(container);\n\n        this._map.on('mousedown', this._clickOut, this);\n\n        return container;\n    },\n\n    _clickOut: function(e) {\n        if (this._sharing) {\n            L.DomEvent.preventDefault(e);\n            L.DomUtil.removeClass(this._modal, 'active');\n            this._content.innerHTML = '';\n            this._sharing = null;\n            return;\n        }\n    },\n\n    _shareClick: function(e) {\n        L.DomEvent.stop(e);\n        if (this._sharing) return this._clickOut(e);\n\n        var tilejson = this._tilejson || this._map._tilejson || {},\n            url = encodeURIComponent(this.options.url || tilejson.webpage || window.location),\n            name = encodeURIComponent(tilejson.name),\n            image = urlhelper('/' + tilejson.id + '/' + this._map.getCenter().lng + ',' + this._map.getCenter().lat + ',' + this._map.getZoom() + '/600x600.png', this.options.accessToken),\n            embed = urlhelper('/' + tilejson.id + '.html', this.options.accessToken),\n            twitter = '//twitter.com/intent/tweet?status=' + name + ' ' + url,\n            facebook = '//www.facebook.com/sharer.php?u=' + url + '&t=' + encodeURIComponent(tilejson.name),\n            pinterest = '//www.pinterest.com/pin/create/button/?url=' + url + '&media=' + image + '&description=' + tilejson.name,\n            share = (\"<h3>Share this map</h3>\" +\n                    \"<div class='mapbox-share-buttons'><a class='mapbox-button mapbox-button-icon mapbox-icon-facebook' target='_blank' href='{{facebook}}'>Facebook</a>\" +\n                    \"<a class='mapbox-button mapbox-button-icon mapbox-icon-twitter' target='_blank' href='{{twitter}}'>Twitter</a>\" +\n                    \"<a class='mapbox-button mapbox-button-icon mapbox-icon-pinterest' target='_blank' href='{{pinterest}}'>Pinterest</a></div>\")\n                    .replace('{{twitter}}', twitter)\n                    .replace('{{facebook}}', facebook)\n                    .replace('{{pinterest}}', pinterest),\n            embedValue = '<iframe width=\"100%\" height=\"500px\" frameBorder=\"0\" src=\"{{embed}}\"></iframe>'.replace('{{embed}}', embed),\n            embedLabel = 'Copy and paste this <strong>HTML code</strong> into documents to embed this map on web pages.';\n\n        L.DomUtil.addClass(this._modal, 'active');\n\n        this._sharing = L.DomUtil.create('div', 'mapbox-modal-body', this._content);\n        this._sharing.innerHTML = share;\n\n        var input = L.DomUtil.create('input', 'mapbox-embed', this._sharing);\n        input.type = 'text';\n        input.value = embedValue;\n\n        var label = L.DomUtil.create('label', 'mapbox-embed-description', this._sharing);\n        label.innerHTML = embedLabel;\n\n        var close = L.DomUtil.create('a', 'leaflet-popup-close-button', this._sharing);\n        close.href = '#';\n\n        L.DomEvent.disableClickPropagation(this._sharing);\n        L.DomEvent.addListener(close, 'click', this._clickOut, this);\n        L.DomEvent.addListener(input, 'click', function(e) {\n            e.target.focus();\n            e.target.select();\n        });\n    }\n});\n\nmodule.exports.ShareControl = ShareControl;\n\nmodule.exports.shareControl = function(_, options) {\n    return new ShareControl(_, options);\n};\n","'use strict';\n\nvar util = require('./util');\n\nvar TileLayer = L.TileLayer.extend({\n    includes: [require('./load_tilejson')],\n\n    options: {\n        format: 'png'\n    },\n\n    // http://mapbox.com/developers/api/#image_quality\n    formats: [\n        'png',\n        // PNG\n        'png32', 'png64', 'png128', 'png256',\n        // JPG\n        'jpg70', 'jpg80', 'jpg90'],\n\n    scalePrefix: '@2x.',\n\n    initialize: function(_, options) {\n        L.TileLayer.prototype.initialize.call(this, undefined, options);\n\n        this._tilejson = {};\n\n        if (options && options.format) {\n            util.strict_oneof(options.format, this.formats);\n        }\n\n        this._loadTileJSON(_);\n    },\n\n    setFormat: function(_) {\n        util.strict(_, 'string');\n        this.options.format = _;\n        this.redraw();\n        return this;\n    },\n\n    // disable the setUrl function, which is not available on mapbox tilelayers\n    setUrl: null,\n\n    _setTileJSON: function(json) {\n        util.strict(json, 'object');\n\n        L.extend(this.options, {\n            tiles: json.tiles,\n            attribution: json.attribution,\n            minZoom: json.minzoom || 0,\n            maxZoom: json.maxzoom || 18,\n            tms: json.scheme === 'tms',\n            bounds: json.bounds && util.lbounds(json.bounds)\n        });\n\n        this._tilejson = json;\n        this.redraw();\n        return this;\n    },\n\n    getTileJSON: function() {\n        return this._tilejson;\n    },\n\n    // this is an exception to mapbox.js naming rules because it's called\n    // by `L.map`\n    getTileUrl: function(tilePoint) {\n        var tiles = this.options.tiles,\n            index = Math.floor(Math.abs(tilePoint.x + tilePoint.y) % tiles.length),\n            url = tiles[index];\n\n        var templated = L.Util.template(url, tilePoint);\n        if (!templated) {\n            return templated;\n        } else {\n            return templated.replace('.png',\n                (L.Browser.retina ? this.scalePrefix : '.') + this.options.format);\n        }\n    },\n\n    // TileJSON.TileLayers are added to the map immediately, so that they get\n    // the desired z-index, but do not update until the TileJSON has been loaded.\n    _update: function() {\n        if (this.options.tiles) {\n            L.TileLayer.prototype._update.call(this);\n        }\n    }\n});\n\nmodule.exports.TileLayer = TileLayer;\n\nmodule.exports.tileLayer = function(_, options) {\n    return new TileLayer(_, options);\n};\n","'use strict';\n\nvar InfoControl = L.Control.extend({\n    options: {\n        position: 'bottomright',\n        sanitizer: require('sanitize-caja')\n    },\n\n    initialize: function(options) {\n        L.setOptions(this, options);\n        this._info = {};\n        console.warn('infoControl has been deprecated and will be removed in mapbox.js v3.0.0. Use the default attribution control instead, which is now responsive.');\n    },\n\n    onAdd: function(map) {\n        this._container = L.DomUtil.create('div', 'mapbox-control-info mapbox-small');\n        this._content = L.DomUtil.create('div', 'map-info-container', this._container);\n\n        var link = L.DomUtil.create('a', 'mapbox-info-toggle mapbox-icon mapbox-icon-info', this._container);\n        link.href = '#';\n\n        L.DomEvent.addListener(link, 'click', this._showInfo, this);\n        L.DomEvent.disableClickPropagation(this._container);\n\n        for (var i in map._layers) {\n            if (map._layers[i].getAttribution) {\n                this.addInfo(map._layers[i].getAttribution());\n            }\n        }\n\n        map\n            .on('layeradd', this._onLayerAdd, this)\n            .on('layerremove', this._onLayerRemove, this);\n\n        this._update();\n        return this._container;\n    },\n\n    onRemove: function(map) {\n        map\n            .off('layeradd', this._onLayerAdd, this)\n            .off('layerremove', this._onLayerRemove, this);\n    },\n\n    addInfo: function(text) {\n        if (!text) return this;\n        if (!this._info[text]) this._info[text] = 0;\n        this._info[text] = true;\n        return this._update();\n    },\n\n    removeInfo: function (text) {\n        if (!text) return this;\n        if (this._info[text]) this._info[text] = false;\n        return this._update();\n    },\n\n    _showInfo: function(e) {\n        L.DomEvent.preventDefault(e);\n        if (this._active === true) return this._hidecontent();\n\n        L.DomUtil.addClass(this._container, 'active');\n        this._active = true;\n        this._update();\n    },\n\n    _hidecontent: function() {\n        this._content.innerHTML = '';\n        this._active = false;\n        L.DomUtil.removeClass(this._container, 'active');\n        return;\n    },\n\n    _update: function() {\n        if (!this._map) { return this; }\n        this._content.innerHTML = '';\n        var hide = 'none';\n        var info = [];\n\n        for (var i in this._info) {\n            if (this._info.hasOwnProperty(i) && this._info[i]) {\n                info.push(this.options.sanitizer(i));\n                hide = 'block';\n            }\n        }\n\n        this._content.innerHTML += info.join(' | ');\n\n        // If there are no results in _info then hide this.\n        this._container.style.display = hide;\n        return this;\n    },\n\n    _onLayerAdd: function(e) {\n        if (e.layer.getAttribution && e.layer.getAttribution()) {\n            this.addInfo(e.layer.getAttribution());\n        } else if ('on' in e.layer && e.layer.getAttribution) {\n            e.layer.on('ready', L.bind(function() {\n                this.addInfo(e.layer.getAttribution());\n            }, this));\n        }\n    },\n\n    _onLayerRemove: function (e) {\n        if (e.layer.getAttribution) {\n            this.removeInfo(e.layer.getAttribution());\n        }\n    }\n});\n\nmodule.exports.InfoControl = InfoControl;\n\nmodule.exports.infoControl = function(options) {\n    return new InfoControl(options);\n};\n","'use strict';\n\nvar util = require('./util'),\n    tileLayer = require('./tile_layer').tileLayer,\n    featureLayer = require('./feature_layer').featureLayer,\n    gridLayer = require('./grid_layer').gridLayer,\n    gridControl = require('./grid_control').gridControl,\n    infoControl = require('./info_control').infoControl,\n    shareControl = require('./share_control').shareControl,\n    legendControl = require('./legend_control').legendControl,\n    mapboxLogoControl = require('./mapbox_logo').mapboxLogoControl,\n    feedback = require('./feedback');\n\nfunction withAccessToken(options, accessToken) {\n    if (!accessToken || options.accessToken)\n        return options;\n    return L.extend({accessToken: accessToken}, options);\n}\n\nvar LMap = L.Map.extend({\n    includes: [require('./load_tilejson')],\n\n    options: {\n        tileLayer: {},\n        featureLayer: {},\n        gridLayer: {},\n        legendControl: {},\n        gridControl: {},\n        infoControl: false,\n        shareControl: false\n    },\n\n    _tilejson: {},\n\n    initialize: function(element, _, options) {\n\n        L.Map.prototype.initialize.call(this, element,\n            L.extend({}, L.Map.prototype.options, options));\n\n        // Disable the default 'Leaflet' text\n        if (this.attributionControl) {\n            this.attributionControl.setPrefix('');\n\n            var compact =  this.options.attributionControl.compact;\n            // Set a compact display if map container width is < 640 or\n            // compact is set to `true` in attributionControl options.\n            if (compact || (compact !== false && this._container.offsetWidth <= 640)) {\n                L.DomUtil.addClass(this.attributionControl._container, 'leaflet-compact-attribution');\n            }\n\n            if (compact === undefined) {\n                this.on('resize', function() {\n                    if (this._container.offsetWidth > 640) {\n                        L.DomUtil.removeClass(this.attributionControl._container, 'leaflet-compact-attribution');\n                    } else {\n                        L.DomUtil.addClass(this.attributionControl._container, 'leaflet-compact-attribution');\n                    }\n                });\n            }\n        }\n\n        if (this.options.tileLayer) {\n            this.tileLayer = tileLayer(undefined,\n                withAccessToken(this.options.tileLayer, this.options.accessToken));\n            this.addLayer(this.tileLayer);\n        }\n\n        if (this.options.featureLayer) {\n            this.featureLayer = featureLayer(undefined,\n                withAccessToken(this.options.featureLayer, this.options.accessToken));\n            this.addLayer(this.featureLayer);\n        }\n\n        if (this.options.gridLayer) {\n            this.gridLayer = gridLayer(undefined,\n                withAccessToken(this.options.gridLayer, this.options.accessToken));\n            this.addLayer(this.gridLayer);\n        }\n\n        if (this.options.gridLayer && this.options.gridControl) {\n            this.gridControl = gridControl(this.gridLayer, this.options.gridControl);\n            this.addControl(this.gridControl);\n        }\n\n        if (this.options.infoControl) {\n            this.infoControl = infoControl(this.options.infoControl);\n            this.addControl(this.infoControl);\n        }\n\n        if (this.options.legendControl) {\n            this.legendControl = legendControl(this.options.legendControl);\n            this.addControl(this.legendControl);\n        }\n\n        if (this.options.shareControl) {\n            this.shareControl = shareControl(undefined,\n                withAccessToken(this.options.shareControl, this.options.accessToken));\n            this.addControl(this.shareControl);\n        }\n\n        this._mapboxLogoControl = mapboxLogoControl(this.options.mapboxLogoControl);\n        this.addControl(this._mapboxLogoControl);\n\n        this._loadTileJSON(_);\n\n        this.on('layeradd', this._onLayerAdd, this)\n            .on('layerremove', this._onLayerRemove, this)\n            .on('moveend', this._updateMapFeedbackLink, this);\n\n        this.whenReady(function () {\n            feedback.on('change', this._updateMapFeedbackLink, this);\n        });\n\n        this.on('unload', function () {\n            feedback.off('change', this._updateMapFeedbackLink, this);\n        });\n    },\n\n    // use a javascript object of tilejson data to configure this layer\n    _setTileJSON: function(_) {\n        this._tilejson = _;\n        this._initialize(_);\n        return this;\n    },\n\n    getTileJSON: function() {\n        return this._tilejson;\n    },\n\n    _initialize: function(json) {\n        if (this.tileLayer) {\n            this.tileLayer._setTileJSON(json);\n            this._updateLayer(this.tileLayer);\n        }\n\n        if (this.featureLayer && !this.featureLayer.getGeoJSON() && json.data && json.data[0]) {\n            this.featureLayer.loadURL(json.data[0]);\n        }\n\n        if (this.gridLayer) {\n            this.gridLayer._setTileJSON(json);\n            this._updateLayer(this.gridLayer);\n        }\n\n        if (this.infoControl && json.attribution) {\n            this.infoControl.addInfo(json.attribution);\n            this._updateMapFeedbackLink();\n        }\n\n        if (this.legendControl && json.legend) {\n            this.legendControl.addLegend(json.legend);\n        }\n\n        if (this.shareControl) {\n            this.shareControl._setTileJSON(json);\n        }\n\n        this._mapboxLogoControl._setTileJSON(json);\n\n        if (!this._loaded && json.center) {\n            var zoom = this.getZoom() !== undefined ? this.getZoom() : json.center[2],\n                center = L.latLng(json.center[1], json.center[0]);\n\n            this.setView(center, zoom);\n        }\n    },\n\n    _updateMapFeedbackLink: function() {\n        if (!this._controlContainer.getElementsByClassName) return;\n        var link = this._controlContainer.getElementsByClassName('mapbox-improve-map');\n        if (link.length && this._loaded) {\n            var center = this.getCenter().wrap();\n            var tilejson = this._tilejson || {};\n            var id = tilejson.id || '';\n\n            var hash = '#' + id + '/' +\n                center.lng.toFixed(3) + '/' +\n                center.lat.toFixed(3) + '/' +\n                this.getZoom();\n\n            for (var key in feedback.data) {\n                hash += '/' + key + '=' + feedback.data[key];\n            }\n\n            for (var i = 0; i < link.length; i++) {\n                link[i].hash = hash;\n            }\n        }\n    },\n\n    _onLayerAdd: function(e) {\n        if ('on' in e.layer) {\n            e.layer.on('ready', this._onLayerReady, this);\n        }\n        window.setTimeout(L.bind(this._updateMapFeedbackLink, this), 0); // Update after attribution control resets the HTML.\n    },\n\n    _onLayerRemove: function(e) {\n        if ('on' in e.layer) {\n            e.layer.off('ready', this._onLayerReady, this);\n        }\n        window.setTimeout(L.bind(this._updateMapFeedbackLink, this), 0); // Update after attribution control resets the HTML.\n    },\n\n    _onLayerReady: function(e) {\n        this._updateLayer(e.target);\n    },\n\n    _updateLayer: function(layer) {\n        if (!layer.options) return;\n\n        if (this.infoControl && this._loaded) {\n            this.infoControl.addInfo(layer.options.infoControl);\n        }\n\n        if (this.attributionControl && this._loaded && layer.getAttribution) {\n            this.attributionControl.addAttribution(layer.getAttribution());\n        }\n\n        if (!(L.stamp(layer) in this._zoomBoundLayers) &&\n                (layer.options.maxZoom || layer.options.minZoom)) {\n            this._zoomBoundLayers[L.stamp(layer)] = layer;\n        }\n\n        this._updateMapFeedbackLink();\n        this._updateZoomLevels();\n    }\n});\n\nmodule.exports.Map = LMap;\n\nmodule.exports.map = function(element, _, options) {\n    return new LMap(element, _, options);\n};\n","'use strict';\n\nvar util = require('./util'),\n    request = require('./request'),\n    grid = require('./grid');\n\n// forked from danzel/L.UTFGrid\nvar GridLayer = L.Class.extend({\n    includes: [L.Mixin.Events, require('./load_tilejson')],\n\n    options: {\n        template: function() { return ''; }\n    },\n\n    _mouseOn: null,\n    _tilejson: {},\n    _cache: {},\n\n    initialize: function(_, options) {\n        L.Util.setOptions(this, options);\n        this._loadTileJSON(_);\n    },\n\n    _setTileJSON: function(json) {\n        util.strict(json, 'object');\n\n        L.extend(this.options, {\n            grids: json.grids,\n            minZoom: json.minzoom,\n            maxZoom: json.maxzoom,\n            bounds: json.bounds && util.lbounds(json.bounds)\n        });\n\n        this._tilejson = json;\n        this._cache = {};\n        this._update();\n\n        return this;\n    },\n\n    getTileJSON: function() {\n        return this._tilejson;\n    },\n\n    active: function() {\n        return !!(this._map && this.options.grids && this.options.grids.length);\n    },\n\n    addTo: function (map) {\n        map.addLayer(this);\n        return this;\n    },\n\n    onAdd: function(map) {\n        this._map = map;\n        this._update();\n\n        this._map\n            .on('click', this._click, this)\n            .on('mousemove', this._move, this)\n            .on('moveend', this._update, this);\n    },\n\n    onRemove: function() {\n        this._map\n            .off('click', this._click, this)\n            .off('mousemove', this._move, this)\n            .off('moveend', this._update, this);\n    },\n\n    getData: function(latlng, callback) {\n        if (!this.active()) return;\n\n        var map = this._map,\n            point = map.project(latlng.wrap()),\n            tileSize = 256,\n            resolution = 4,\n            x = Math.floor(point.x / tileSize),\n            y = Math.floor(point.y / tileSize),\n            max = map.options.crs.scale(map.getZoom()) / tileSize;\n\n        x = (x + max) % max;\n        y = (y + max) % max;\n\n        this._getTile(map.getZoom(), x, y, function(grid) {\n            var gridX = Math.floor((point.x - (x * tileSize)) / resolution),\n                gridY = Math.floor((point.y - (y * tileSize)) / resolution);\n\n            callback(grid(gridX, gridY));\n        });\n\n        return this;\n    },\n\n    _click: function(e) {\n        this.getData(e.latlng, L.bind(function(data) {\n            this.fire('click', {\n                latLng: e.latlng,\n                data: data\n            });\n        }, this));\n    },\n\n    _move: function(e) {\n        this.getData(e.latlng, L.bind(function(data) {\n            if (data !== this._mouseOn) {\n                if (this._mouseOn) {\n                    this.fire('mouseout', {\n                        latLng: e.latlng,\n                        data: this._mouseOn\n                    });\n                }\n\n                this.fire('mouseover', {\n                    latLng: e.latlng,\n                    data: data\n                });\n\n                this._mouseOn = data;\n            } else {\n                this.fire('mousemove', {\n                    latLng: e.latlng,\n                    data: data\n                });\n            }\n        }, this));\n    },\n\n    _getTileURL: function(tilePoint) {\n        var urls = this.options.grids,\n            index = (tilePoint.x + tilePoint.y) % urls.length,\n            url = urls[index];\n\n        return L.Util.template(url, tilePoint);\n    },\n\n    // Load up all required json grid files\n    _update: function() {\n        if (!this.active()) return;\n\n        var bounds = this._map.getPixelBounds(),\n            z = this._map.getZoom(),\n            tileSize = 256;\n\n        if (z > this.options.maxZoom || z < this.options.minZoom) return;\n\n        var tileBounds = L.bounds(\n                bounds.min.divideBy(tileSize)._floor(),\n                bounds.max.divideBy(tileSize)._floor()),\n            max = this._map.options.crs.scale(z) / tileSize;\n\n        for (var x = tileBounds.min.x; x <= tileBounds.max.x; x++) {\n            for (var y = tileBounds.min.y; y <= tileBounds.max.y; y++) {\n                // x wrapped\n                this._getTile(z, ((x % max) + max) % max, ((y % max) + max) % max);\n            }\n        }\n    },\n\n    _getTile: function(z, x, y, callback) {\n        var key = z + '_' + x + '_' + y,\n            tilePoint = L.point(x, y);\n\n        tilePoint.z = z;\n\n        if (!this._tileShouldBeLoaded(tilePoint)) {\n            return;\n        }\n\n        if (key in this._cache) {\n            if (!callback) return;\n\n            if (typeof this._cache[key] === 'function') {\n                callback(this._cache[key]); // Already loaded\n            } else {\n                this._cache[key].push(callback); // Pending\n            }\n\n            return;\n        }\n\n        this._cache[key] = [];\n\n        if (callback) {\n            this._cache[key].push(callback);\n        }\n\n        request(this._getTileURL(tilePoint), L.bind(function(err, json) {\n            var callbacks = this._cache[key];\n            this._cache[key] = grid(json);\n            for (var i = 0; i < callbacks.length; ++i) {\n                callbacks[i](this._cache[key]);\n            }\n        }, this));\n    },\n\n    _tileShouldBeLoaded: function(tilePoint) {\n        if (tilePoint.z > this.options.maxZoom || tilePoint.z < this.options.minZoom) {\n            return false;\n        }\n\n        if (this.options.bounds) {\n            var tileSize = 256,\n                nwPoint = tilePoint.multiplyBy(tileSize),\n                sePoint = nwPoint.add(new L.Point(tileSize, tileSize)),\n                nw = this._map.unproject(nwPoint),\n                se = this._map.unproject(sePoint),\n                bounds = new L.LatLngBounds([nw, se]);\n\n            if (!this.options.bounds.intersects(bounds)) {\n                return false;\n            }\n        }\n\n        return true;\n    }\n});\n\nmodule.exports.GridLayer = GridLayer;\n\nmodule.exports.gridLayer = function(_, options) {\n    return new GridLayer(_, options);\n};\n","'use strict';\n\nvar util = require('./util'),\n    urlhelper = require('./url'),\n    feedback = require('./feedback'),\n    request = require('./request');\n\n// Low-level geocoding interface - wraps specific API calls and their\n// return values.\nmodule.exports = function(url, options) {\n\n    var geocoder = {};\n\n    util.strict(url, 'string');\n\n    if (url.indexOf('/') === -1) {\n        url = urlhelper('/geocode/' + url + '/{query}.json', options && options.accessToken);\n    }\n\n    geocoder.getURL = function() {\n        return url;\n    };\n\n    geocoder.queryURL = function(_) {\n        var query;\n\n        if (typeof _ !== 'string') {\n            var parts = [];\n            for (var i = 0; i < _.length; i++) {\n                parts[i] = encodeURIComponent(_[i]);\n            }\n            query = parts.join(';');\n        } else {\n            query = encodeURIComponent(_);\n        }\n\n        feedback.record({geocoding: query});\n        return L.Util.template(geocoder.getURL(), {query: query});\n    };\n\n    geocoder.query = function(_, callback) {\n        util.strict(callback, 'function');\n        request(geocoder.queryURL(_), function(err, json) {\n            if (json && (json.length || json.features)) {\n                var res = {\n                    results: json\n                };\n                if (json.features && json.features.length) {\n                    res.latlng = [\n                        json.features[0].center[1],\n                        json.features[0].center[0]];\n\n                    if (json.features[0].bbox) {\n                        res.bounds = json.features[0].bbox;\n                        res.lbounds = util.lbounds(res.bounds);\n                    }\n                }\n                callback(null, res);\n            } else callback(err || true);\n        });\n\n        return geocoder;\n    };\n\n    // a reverse geocode:\n    //\n    //  geocoder.reverseQuery([80, 20])\n    geocoder.reverseQuery = function(_, callback) {\n        var q = '';\n\n        // sort through different ways people represent lat and lon pairs\n        function normalize(x) {\n            if (x.lat !== undefined && x.lng !== undefined) {\n                return x.lng + ',' + x.lat;\n            } else if (x.lat !== undefined && x.lon !== undefined) {\n                return x.lon + ',' + x.lat;\n            } else {\n                return x[0] + ',' + x[1];\n            }\n        }\n\n        if (_.length && _[0].length) {\n            for (var i = 0, pts = []; i < _.length; i++) {\n                pts.push(normalize(_[i]));\n            }\n            q = pts.join(';');\n        } else {\n            q = normalize(_);\n        }\n\n        request(geocoder.queryURL(q), function(err, json) {\n            callback(err, json);\n        });\n\n        return geocoder;\n    };\n\n    return geocoder;\n};\n","'use strict';\n\nvar url = require('./url'),\n    util = require('./util'),\n    sanitize = require('sanitize-caja');\n\n// mapbox-related markers functionality\n// provide an icon from mapbox's simple-style spec and hosted markers\n// service\nfunction icon(fp, options) {\n    fp = fp || {};\n\n    var sizes = {\n            small: [20, 50],\n            medium: [30, 70],\n            large: [35, 90]\n        },\n        size = fp['marker-size'] || 'medium',\n        symbol = ('marker-symbol' in fp && fp['marker-symbol'] !== '') ? '-' + fp['marker-symbol'] : '',\n        color = (fp['marker-color'] || '7e7e7e').replace('#', '');\n\n    return L.icon({\n        iconUrl: url('/marker/' +\n            'pin-' + size.charAt(0) + symbol + '+' + color +\n            // detect and use retina markers, which are x2 resolution\n            (L.Browser.retina ? '@2x' : '') + '.png', options && options.accessToken),\n        iconSize: sizes[size],\n        iconAnchor: [sizes[size][0] / 2, sizes[size][1] / 2],\n        popupAnchor: [0, -sizes[size][1] / 2]\n    });\n}\n\n// a factory that provides markers for Leaflet from Mapbox's\n// [simple-style specification](https://github.com/mapbox/simplestyle-spec)\n// and [Markers API](http://mapbox.com/developers/api/#markers).\nfunction style(f, latlon, options) {\n    return L.marker(latlon, {\n        icon: icon(f.properties, options),\n        title: util.strip_tags(\n            sanitize((f.properties && f.properties.title) || ''))\n    });\n}\n\n// Sanitize and format properties of a GeoJSON Feature object in order\n// to form the HTML string used as the argument for `L.createPopup`\nfunction createPopup(f, sanitizer) {\n    if (!f || !f.properties) return '';\n    var popup = '';\n\n    if (f.properties.title) {\n        popup += '<div class=\"marker-title\">' + f.properties.title + '</div>';\n    }\n\n    if (f.properties.description) {\n        popup += '<div class=\"marker-description\">' + f.properties.description + '</div>';\n    }\n\n    return (sanitizer || sanitize)(popup);\n}\n\nmodule.exports = {\n    icon: icon,\n    style: style,\n    createPopup: createPopup\n};\n","'use strict';\n\n// an implementation of the simplestyle spec for polygon and linestring features\n// https://github.com/mapbox/simplestyle-spec\nvar defaults = {\n    stroke: '#555555',\n    'stroke-width': 2,\n    'stroke-opacity': 1,\n    fill: '#555555',\n    'fill-opacity': 0.5\n};\n\nvar mapping = [\n    ['stroke', 'color'],\n    ['stroke-width', 'weight'],\n    ['stroke-opacity', 'opacity'],\n    ['fill', 'fillColor'],\n    ['fill-opacity', 'fillOpacity']\n];\n\nfunction fallback(a, b) {\n    var c = {};\n    for (var k in b) {\n        if (a[k] === undefined) c[k] = b[k];\n        else c[k] = a[k];\n    }\n    return c;\n}\n\nfunction remap(a) {\n    var d = {};\n    for (var i = 0; i < mapping.length; i++) {\n        d[mapping[i][1]] = a[mapping[i][0]];\n    }\n    return d;\n}\n\nfunction style(feature) {\n    return remap(fallback(feature.properties || {}, defaults));\n}\n\nmodule.exports = {\n    style: style,\n    defaults: defaults\n};\n","'use strict';\n\nmodule.exports = {\n    HTTP_URL: 'http://a.tiles.mapbox.com/v4',\n    HTTPS_URL: 'https://a.tiles.mapbox.com/v4',\n    FORCE_HTTPS: false,\n    REQUIRE_ACCESS_TOKEN: true\n};\n","'use strict';\n\nvar Feedback = L.Class.extend({\n    includes: L.Mixin.Events,\n    data: {},\n    record: function(data) {\n        L.extend(this.data, data);\n        this.fire('change');\n    }\n});\n\nmodule.exports = new Feedback();\n","'use strict';\n\nmodule.exports = {\n    idUrl: function(_, t) {\n        if (_.indexOf('/') == -1) t.loadID(_);\n        else t.loadURL(_);\n    },\n    log: function(_) {\n        if (typeof console === 'object' &&\n            typeof console.error === 'function') {\n            console.error(_);\n        }\n    },\n    strict: function(_, type) {\n        if (typeof _ !== type) {\n            throw new Error('Invalid argument: ' + type + ' expected');\n        }\n    },\n    strict_instance: function(_, klass, name) {\n        if (!(_ instanceof klass)) {\n            throw new Error('Invalid argument: ' + name + ' expected');\n        }\n    },\n    strict_oneof: function(_, values) {\n        if (!contains(_, values)) {\n            throw new Error('Invalid argument: ' + _ + ' given, valid values are ' +\n                values.join(', '));\n        }\n    },\n    strip_tags: function(_) {\n        return _.replace(/<[^<]+>/g, '');\n    },\n    lbounds: function(_) {\n        // leaflet-compatible bounds, since leaflet does not do geojson\n        return new L.LatLngBounds([[_[1], _[0]], [_[3], _[2]]]);\n    }\n};\n\nfunction contains(item, list) {\n    if (!list || !list.length) return false;\n    for (var i = 0; i < list.length; i++) {\n        if (list[i] == item) return true;\n    }\n    return false;\n}\n","'use strict';\n\nvar config = require('./config'),\n    version = require('../package.json').version;\n\nmodule.exports = function(path, accessToken) {\n    accessToken = accessToken || L.mapbox.accessToken;\n\n    if (!accessToken && config.REQUIRE_ACCESS_TOKEN) {\n        throw new Error('An API access token is required to use Mapbox.js. ' +\n            'See https://www.mapbox.com/mapbox.js/api/v' + version + '/api-access-tokens/');\n    }\n\n    var url = ('https:' === document.location.protocol || config.FORCE_HTTPS) ? config.HTTPS_URL : config.HTTP_URL;\n    url += path;\n    url += url.indexOf('?') !== -1 ? '&access_token=' : '?access_token=';\n\n    if (config.REQUIRE_ACCESS_TOKEN) {\n        if (accessToken[0] === 's') {\n            throw new Error('Use a public access token (pk.*) with Mapbox.js, not a secret access token (sk.*). ' +\n                'See https://www.mapbox.com/mapbox.js/api/v' + version + '/api-access-tokens/');\n        }\n\n        url += accessToken;\n    }\n\n    return url;\n};\n\nmodule.exports.tileJSON = function(urlOrMapID, accessToken) {\n    if (urlOrMapID.indexOf('/') !== -1)\n        return urlOrMapID;\n\n    var url = module.exports('/' + urlOrMapID + '.json', accessToken);\n\n    // TileJSON requests need a secure flag appended to their URLs so\n    // that the server knows to send SSL-ified resource references.\n    if (url.indexOf('https') === 0)\n        url += '&secure';\n\n    return url;\n};\n","'use strict';\n\nvar corslite = require('corslite'),\n    strict = require('./util').strict,\n    config = require('./config'),\n    protocol = /^(https?:)?(?=\\/\\/(.|api)\\.tiles\\.mapbox\\.com\\/)/;\n\nmodule.exports = function(url, callback) {\n    strict(url, 'string');\n    strict(callback, 'function');\n\n    url = url.replace(protocol, function(match, protocol) {\n        if (!('withCredentials' in new window.XMLHttpRequest())) {\n            // XDomainRequest in use; doesn't support cross-protocol requests\n            return document.location.protocol;\n        } else if ('https:' === protocol || 'https:' === document.location.protocol || config.FORCE_HTTPS) {\n            return 'https:';\n        } else {\n            return 'http:';\n        }\n    });\n\n    return corslite(url, onload);\n    function onload(err, resp) {\n        if (!err && resp) {\n            resp = JSON.parse(resp.responseText);\n        }\n        callback(err, resp);\n    }\n};\n","'use strict';\n\nvar request = require('./request'),\n    url = require('./url'),\n    util = require('./util');\n\nmodule.exports = {\n    _loadTileJSON: function(_) {\n        if (typeof _ === 'string') {\n            _ = url.tileJSON(_, this.options && this.options.accessToken);\n            request(_, L.bind(function(err, json) {\n                if (err) {\n                    util.log('could not load TileJSON at ' + _);\n                    this.fire('error', {error: err});\n                } else if (json) {\n                    this._setTileJSON(json);\n                    this.fire('ready');\n                }\n            }, this));\n        } else if (_ && typeof _ === 'object') {\n            this._setTileJSON(_);\n        }\n    }\n};\n","'use strict';\n\nvar MapboxLogoControl = L.Control.extend({\n\n    options: {\n        position: 'bottomleft',\n    },\n\n    initialize: function(options) {\n        L.setOptions(this, options);\n    },\n\n    onAdd: function(map) {\n        this._container = L.DomUtil.create('div', 'mapbox-logo');\n        return this._container;\n    },\n\n    _setTileJSON: function(json) {\n        // Check if account referenced by the accessToken\n        // is asscociated with the Mapbox Logo\n        // as determined by mapbox-maps.\n        if (json.mapbox_logo) {\n            L.DomUtil.addClass(this._container, 'mapbox-logo-true');\n        }\n    }\n});\n\nmodule.exports.MapboxLogoControl = MapboxLogoControl;\n\nmodule.exports.mapboxLogoControl = function(options) {\n    return new MapboxLogoControl(options);\n};\n","'use strict';\n\nfunction utfDecode(c) {\n    if (c >= 93) c--;\n    if (c >= 35) c--;\n    return c - 32;\n}\n\nmodule.exports = function(data) {\n    return function(x, y) {\n        if (!data) return;\n        var idx = utfDecode(data.grid[y].charCodeAt(x)),\n            key = data.keys[idx];\n        return data.data[key];\n    };\n};\n","var html_sanitize = require('./sanitizer-bundle.js');\n\nmodule.exports = function(_) {\n    if (!_) return '';\n    return html_sanitize(_, cleanUrl, cleanId);\n};\n\n// https://bugzilla.mozilla.org/show_bug.cgi?id=255107\nfunction cleanUrl(url) {\n    'use strict';\n    if (/^https?/.test(url.getScheme())) return url.toString();\n    if (/^mailto?/.test(url.getScheme())) return url.toString();\n    if ('data' == url.getScheme() && /^image/.test(url.getPath())) {\n        return url.toString();\n    }\n}\n\nfunction cleanId(id) { return id; }\n","/*!\n * mustache.js - Logic-less {{mustache}} templates with JavaScript\n * http://github.com/janl/mustache.js\n */\n\n/*global define: false*/\n\n(function (root, factory) {\n  if (typeof exports === \"object\" && exports) {\n    factory(exports); // CommonJS\n  } else {\n    var mustache = {};\n    factory(mustache);\n    if (typeof define === \"function\" && define.amd) {\n      define(mustache); // AMD\n    } else {\n      root.Mustache = mustache; // <script>\n    }\n  }\n}(this, function (mustache) {\n\n  var whiteRe = /\\s*/;\n  var spaceRe = /\\s+/;\n  var nonSpaceRe = /\\S/;\n  var eqRe = /\\s*=/;\n  var curlyRe = /\\s*\\}/;\n  var tagRe = /#|\\^|\\/|>|\\{|&|=|!/;\n\n  // Workaround for https://issues.apache.org/jira/browse/COUCHDB-577\n  // See https://github.com/janl/mustache.js/issues/189\n  var RegExp_test = RegExp.prototype.test;\n  function testRegExp(re, string) {\n    return RegExp_test.call(re, string);\n  }\n\n  function isWhitespace(string) {\n    return !testRegExp(nonSpaceRe, string);\n  }\n\n  var Object_toString = Object.prototype.toString;\n  var isArray = Array.isArray || function (object) {\n    return Object_toString.call(object) === '[object Array]';\n  };\n\n  function isFunction(object) {\n    return typeof object === 'function';\n  }\n\n  function escapeRegExp(string) {\n    return string.replace(/[\\-\\[\\]{}()*+?.,\\\\\\^$|#\\s]/g, \"\\\\$&\");\n  }\n\n  var entityMap = {\n    \"&\": \"&amp;\",\n    \"<\": \"&lt;\",\n    \">\": \"&gt;\",\n    '\"': '&quot;',\n    \"'\": '&#39;',\n    \"/\": '&#x2F;'\n  };\n\n  function escapeHtml(string) {\n    return String(string).replace(/[&<>\"'\\/]/g, function (s) {\n      return entityMap[s];\n    });\n  }\n\n  function Scanner(string) {\n    this.string = string;\n    this.tail = string;\n    this.pos = 0;\n  }\n\n  /**\n   * Returns `true` if the tail is empty (end of string).\n   */\n  Scanner.prototype.eos = function () {\n    return this.tail === \"\";\n  };\n\n  /**\n   * Tries to match the given regular expression at the current position.\n   * Returns the matched text if it can match, the empty string otherwise.\n   */\n  Scanner.prototype.scan = function (re) {\n    var match = this.tail.match(re);\n\n    if (match && match.index === 0) {\n      var string = match[0];\n      this.tail = this.tail.substring(string.length);\n      this.pos += string.length;\n      return string;\n    }\n\n    return \"\";\n  };\n\n  /**\n   * Skips all text until the given regular expression can be matched. Returns\n   * the skipped string, which is the entire tail if no match can be made.\n   */\n  Scanner.prototype.scanUntil = function (re) {\n    var index = this.tail.search(re), match;\n\n    switch (index) {\n    case -1:\n      match = this.tail;\n      this.tail = \"\";\n      break;\n    case 0:\n      match = \"\";\n      break;\n    default:\n      match = this.tail.substring(0, index);\n      this.tail = this.tail.substring(index);\n    }\n\n    this.pos += match.length;\n\n    return match;\n  };\n\n  function Context(view, parent) {\n    this.view = view == null ? {} : view;\n    this.parent = parent;\n    this._cache = { '.': this.view };\n  }\n\n  Context.make = function (view) {\n    return (view instanceof Context) ? view : new Context(view);\n  };\n\n  Context.prototype.push = function (view) {\n    return new Context(view, this);\n  };\n\n  Context.prototype.lookup = function (name) {\n    var value;\n    if (name in this._cache) {\n      value = this._cache[name];\n    } else {\n      var context = this;\n\n      while (context) {\n        if (name.indexOf('.') > 0) {\n          value = context.view;\n\n          var names = name.split('.'), i = 0;\n          while (value != null && i < names.length) {\n            value = value[names[i++]];\n          }\n        } else {\n          value = context.view[name];\n        }\n\n        if (value != null) break;\n\n        context = context.parent;\n      }\n\n      this._cache[name] = value;\n    }\n\n    if (isFunction(value)) {\n      value = value.call(this.view);\n    }\n\n    return value;\n  };\n\n  function Writer() {\n    this.clearCache();\n  }\n\n  Writer.prototype.clearCache = function () {\n    this._cache = {};\n    this._partialCache = {};\n  };\n\n  Writer.prototype.compile = function (template, tags) {\n    var fn = this._cache[template];\n\n    if (!fn) {\n      var tokens = mustache.parse(template, tags);\n      fn = this._cache[template] = this.compileTokens(tokens, template);\n    }\n\n    return fn;\n  };\n\n  Writer.prototype.compilePartial = function (name, template, tags) {\n    var fn = this.compile(template, tags);\n    this._partialCache[name] = fn;\n    return fn;\n  };\n\n  Writer.prototype.getPartial = function (name) {\n    if (!(name in this._partialCache) && this._loadPartial) {\n      this.compilePartial(name, this._loadPartial(name));\n    }\n\n    return this._partialCache[name];\n  };\n\n  Writer.prototype.compileTokens = function (tokens, template) {\n    var self = this;\n    return function (view, partials) {\n      if (partials) {\n        if (isFunction(partials)) {\n          self._loadPartial = partials;\n        } else {\n          for (var name in partials) {\n            self.compilePartial(name, partials[name]);\n          }\n        }\n      }\n\n      return renderTokens(tokens, self, Context.make(view), template);\n    };\n  };\n\n  Writer.prototype.render = function (template, view, partials) {\n    return this.compile(template)(view, partials);\n  };\n\n  /**\n   * Low-level function that renders the given `tokens` using the given `writer`\n   * and `context`. The `template` string is only needed for templates that use\n   * higher-order sections to extract the portion of the original template that\n   * was contained in that section.\n   */\n  function renderTokens(tokens, writer, context, template) {\n    var buffer = '';\n\n    // This function is used to render an artbitrary template\n    // in the current context by higher-order functions.\n    function subRender(template) {\n      return writer.render(template, context);\n    }\n\n    var token, tokenValue, value;\n    for (var i = 0, len = tokens.length; i < len; ++i) {\n      token = tokens[i];\n      tokenValue = token[1];\n\n      switch (token[0]) {\n      case '#':\n        value = context.lookup(tokenValue);\n\n        if (typeof value === 'object' || typeof value === 'string') {\n          if (isArray(value)) {\n            for (var j = 0, jlen = value.length; j < jlen; ++j) {\n              buffer += renderTokens(token[4], writer, context.push(value[j]), template);\n            }\n          } else if (value) {\n            buffer += renderTokens(token[4], writer, context.push(value), template);\n          }\n        } else if (isFunction(value)) {\n          var text = template == null ? null : template.slice(token[3], token[5]);\n          value = value.call(context.view, text, subRender);\n          if (value != null) buffer += value;\n        } else if (value) {\n          buffer += renderTokens(token[4], writer, context, template);\n        }\n\n        break;\n      case '^':\n        value = context.lookup(tokenValue);\n\n        // Use JavaScript's definition of falsy. Include empty arrays.\n        // See https://github.com/janl/mustache.js/issues/186\n        if (!value || (isArray(value) && value.length === 0)) {\n          buffer += renderTokens(token[4], writer, context, template);\n        }\n\n        break;\n      case '>':\n        value = writer.getPartial(tokenValue);\n        if (isFunction(value)) buffer += value(context);\n        break;\n      case '&':\n        value = context.lookup(tokenValue);\n        if (value != null) buffer += value;\n        break;\n      case 'name':\n        value = context.lookup(tokenValue);\n        if (value != null) buffer += mustache.escape(value);\n        break;\n      case 'text':\n        buffer += tokenValue;\n        break;\n      }\n    }\n\n    return buffer;\n  }\n\n  /**\n   * Forms the given array of `tokens` into a nested tree structure where\n   * tokens that represent a section have two additional items: 1) an array of\n   * all tokens that appear in that section and 2) the index in the original\n   * template that represents the end of that section.\n   */\n  function nestTokens(tokens) {\n    var tree = [];\n    var collector = tree;\n    var sections = [];\n\n    var token;\n    for (var i = 0, len = tokens.length; i < len; ++i) {\n      token = tokens[i];\n      switch (token[0]) {\n      case '#':\n      case '^':\n        sections.push(token);\n        collector.push(token);\n        collector = token[4] = [];\n        break;\n      case '/':\n        var section = sections.pop();\n        section[5] = token[2];\n        collector = sections.length > 0 ? sections[sections.length - 1][4] : tree;\n        break;\n      default:\n        collector.push(token);\n      }\n    }\n\n    return tree;\n  }\n\n  /**\n   * Combines the values of consecutive text tokens in the given `tokens` array\n   * to a single token.\n   */\n  function squashTokens(tokens) {\n    var squashedTokens = [];\n\n    var token, lastToken;\n    for (var i = 0, len = tokens.length; i < len; ++i) {\n      token = tokens[i];\n      if (token) {\n        if (token[0] === 'text' && lastToken && lastToken[0] === 'text') {\n          lastToken[1] += token[1];\n          lastToken[3] = token[3];\n        } else {\n          lastToken = token;\n          squashedTokens.push(token);\n        }\n      }\n    }\n\n    return squashedTokens;\n  }\n\n  function escapeTags(tags) {\n    return [\n      new RegExp(escapeRegExp(tags[0]) + \"\\\\s*\"),\n      new RegExp(\"\\\\s*\" + escapeRegExp(tags[1]))\n    ];\n  }\n\n  /**\n   * Breaks up the given `template` string into a tree of token objects. If\n   * `tags` is given here it must be an array with two string values: the\n   * opening and closing tags used in the template (e.g. [\"<%\", \"%>\"]). Of\n   * course, the default is to use mustaches (i.e. Mustache.tags).\n   */\n  function parseTemplate(template, tags) {\n    template = template || '';\n    tags = tags || mustache.tags;\n\n    if (typeof tags === 'string') tags = tags.split(spaceRe);\n    if (tags.length !== 2) throw new Error('Invalid tags: ' + tags.join(', '));\n\n    var tagRes = escapeTags(tags);\n    var scanner = new Scanner(template);\n\n    var sections = [];     // Stack to hold section tokens\n    var tokens = [];       // Buffer to hold the tokens\n    var spaces = [];       // Indices of whitespace tokens on the current line\n    var hasTag = false;    // Is there a {{tag}} on the current line?\n    var nonSpace = false;  // Is there a non-space char on the current line?\n\n    // Strips all whitespace tokens array for the current line\n    // if there was a {{#tag}} on it and otherwise only space.\n    function stripSpace() {\n      if (hasTag && !nonSpace) {\n        while (spaces.length) {\n          delete tokens[spaces.pop()];\n        }\n      } else {\n        spaces = [];\n      }\n\n      hasTag = false;\n      nonSpace = false;\n    }\n\n    var start, type, value, chr, token, openSection;\n    while (!scanner.eos()) {\n      start = scanner.pos;\n\n      // Match any text between tags.\n      value = scanner.scanUntil(tagRes[0]);\n      if (value) {\n        for (var i = 0, len = value.length; i < len; ++i) {\n          chr = value.charAt(i);\n\n          if (isWhitespace(chr)) {\n            spaces.push(tokens.length);\n          } else {\n            nonSpace = true;\n          }\n\n          tokens.push(['text', chr, start, start + 1]);\n          start += 1;\n\n          // Check for whitespace on the current line.\n          if (chr == '\\n') stripSpace();\n        }\n      }\n\n      // Match the opening tag.\n      if (!scanner.scan(tagRes[0])) break;\n      hasTag = true;\n\n      // Get the tag type.\n      type = scanner.scan(tagRe) || 'name';\n      scanner.scan(whiteRe);\n\n      // Get the tag value.\n      if (type === '=') {\n        value = scanner.scanUntil(eqRe);\n        scanner.scan(eqRe);\n        scanner.scanUntil(tagRes[1]);\n      } else if (type === '{') {\n        value = scanner.scanUntil(new RegExp('\\\\s*' + escapeRegExp('}' + tags[1])));\n        scanner.scan(curlyRe);\n        scanner.scanUntil(tagRes[1]);\n        type = '&';\n      } else {\n        value = scanner.scanUntil(tagRes[1]);\n      }\n\n      // Match the closing tag.\n      if (!scanner.scan(tagRes[1])) throw new Error('Unclosed tag at ' + scanner.pos);\n\n      token = [type, value, start, scanner.pos];\n      tokens.push(token);\n\n      if (type === '#' || type === '^') {\n        sections.push(token);\n      } else if (type === '/') {\n        // Check section nesting.\n        openSection = sections.pop();\n        if (!openSection) {\n          throw new Error('Unopened section \"' + value + '\" at ' + start);\n        }\n        if (openSection[1] !== value) {\n          throw new Error('Unclosed section \"' + openSection[1] + '\" at ' + start);\n        }\n      } else if (type === 'name' || type === '{' || type === '&') {\n        nonSpace = true;\n      } else if (type === '=') {\n        // Set the tags for the next time around.\n        tags = value.split(spaceRe);\n        if (tags.length !== 2) {\n          throw new Error('Invalid tags at ' + start + ': ' + tags.join(', '));\n        }\n        tagRes = escapeTags(tags);\n      }\n    }\n\n    // Make sure there are no open sections when we're done.\n    openSection = sections.pop();\n    if (openSection) {\n      throw new Error('Unclosed section \"' + openSection[1] + '\" at ' + scanner.pos);\n    }\n\n    return nestTokens(squashTokens(tokens));\n  }\n\n  mustache.name = \"mustache.js\";\n  mustache.version = \"0.7.3\";\n  mustache.tags = [\"{{\", \"}}\"];\n\n  mustache.Scanner = Scanner;\n  mustache.Context = Context;\n  mustache.Writer = Writer;\n\n  mustache.parse = parseTemplate;\n\n  // Export the escaping function so that the user may override it.\n  // See https://github.com/janl/mustache.js/issues/244\n  mustache.escape = escapeHtml;\n\n  // All Mustache.* functions use this writer.\n  var defaultWriter = new Writer();\n\n  /**\n   * Clears all cached templates and partials in the default writer.\n   */\n  mustache.clearCache = function () {\n    return defaultWriter.clearCache();\n  };\n\n  /**\n   * Compiles the given `template` to a reusable function using the default\n   * writer.\n   */\n  mustache.compile = function (template, tags) {\n    return defaultWriter.compile(template, tags);\n  };\n\n  /**\n   * Compiles the partial with the given `name` and `template` to a reusable\n   * function using the default writer.\n   */\n  mustache.compilePartial = function (name, template, tags) {\n    return defaultWriter.compilePartial(name, template, tags);\n  };\n\n  /**\n   * Compiles the given array of tokens (the output of a parse) to a reusable\n   * function using the default writer.\n   */\n  mustache.compileTokens = function (tokens, template) {\n    return defaultWriter.compileTokens(tokens, template);\n  };\n\n  /**\n   * Renders the `template` with the given `view` and `partials` using the\n   * default writer.\n   */\n  mustache.render = function (template, view, partials) {\n    return defaultWriter.render(template, view, partials);\n  };\n\n  // This is here for backwards compatibility with 0.4.x.\n  mustache.to_html = function (template, view, partials, send) {\n    var result = mustache.render(template, view, partials);\n\n    if (isFunction(send)) {\n      send(result);\n    } else {\n      return result;\n    }\n  };\n\n}));\n","\n// Copyright (C) 2010 Google Inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//      http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\n/**\n * @fileoverview\n * Implements RFC 3986 for parsing/formatting URIs.\n *\n * @author mikesamuel@gmail.com\n * \\@provides URI\n * \\@overrides window\n */\n\nvar URI = (function () {\n\n/**\n * creates a uri from the string form.  The parser is relaxed, so special\n * characters that aren't escaped but don't cause ambiguities will not cause\n * parse failures.\n *\n * @return {URI|null}\n */\nfunction parse(uriStr) {\n  var m = ('' + uriStr).match(URI_RE_);\n  if (!m) { return null; }\n  return new URI(\n      nullIfAbsent(m[1]),\n      nullIfAbsent(m[2]),\n      nullIfAbsent(m[3]),\n      nullIfAbsent(m[4]),\n      nullIfAbsent(m[5]),\n      nullIfAbsent(m[6]),\n      nullIfAbsent(m[7]));\n}\n\n\n/**\n * creates a uri from the given parts.\n *\n * @param scheme {string} an unencoded scheme such as \"http\" or null\n * @param credentials {string} unencoded user credentials or null\n * @param domain {string} an unencoded domain name or null\n * @param port {number} a port number in [1, 32768].\n *    -1 indicates no port, as does null.\n * @param path {string} an unencoded path\n * @param query {Array.<string>|string|null} a list of unencoded cgi\n *   parameters where even values are keys and odds the corresponding values\n *   or an unencoded query.\n * @param fragment {string} an unencoded fragment without the \"#\" or null.\n * @return {URI}\n */\nfunction create(scheme, credentials, domain, port, path, query, fragment) {\n  var uri = new URI(\n      encodeIfExists2(scheme, URI_DISALLOWED_IN_SCHEME_OR_CREDENTIALS_),\n      encodeIfExists2(\n          credentials, URI_DISALLOWED_IN_SCHEME_OR_CREDENTIALS_),\n      encodeIfExists(domain),\n      port > 0 ? port.toString() : null,\n      encodeIfExists2(path, URI_DISALLOWED_IN_PATH_),\n      null,\n      encodeIfExists(fragment));\n  if (query) {\n    if ('string' === typeof query) {\n      uri.setRawQuery(query.replace(/[^?&=0-9A-Za-z_\\-~.%]/g, encodeOne));\n    } else {\n      uri.setAllParameters(query);\n    }\n  }\n  return uri;\n}\nfunction encodeIfExists(unescapedPart) {\n  if ('string' == typeof unescapedPart) {\n    return encodeURIComponent(unescapedPart);\n  }\n  return null;\n};\n/**\n * if unescapedPart is non null, then escapes any characters in it that aren't\n * valid characters in a url and also escapes any special characters that\n * appear in extra.\n *\n * @param unescapedPart {string}\n * @param extra {RegExp} a character set of characters in [\\01-\\177].\n * @return {string|null} null iff unescapedPart == null.\n */\nfunction encodeIfExists2(unescapedPart, extra) {\n  if ('string' == typeof unescapedPart) {\n    return encodeURI(unescapedPart).replace(extra, encodeOne);\n  }\n  return null;\n};\n/** converts a character in [\\01-\\177] to its url encoded equivalent. */\nfunction encodeOne(ch) {\n  var n = ch.charCodeAt(0);\n  return '%' + '0123456789ABCDEF'.charAt((n >> 4) & 0xf) +\n      '0123456789ABCDEF'.charAt(n & 0xf);\n}\n\n/**\n * {@updoc\n *  $ normPath('foo/./bar')\n *  # 'foo/bar'\n *  $ normPath('./foo')\n *  # 'foo'\n *  $ normPath('foo/.')\n *  # 'foo'\n *  $ normPath('foo//bar')\n *  # 'foo/bar'\n * }\n */\nfunction normPath(path) {\n  return path.replace(/(^|\\/)\\.(?:\\/|$)/g, '$1').replace(/\\/{2,}/g, '/');\n}\n\nvar PARENT_DIRECTORY_HANDLER = new RegExp(\n    ''\n    // A path break\n    + '(/|^)'\n    // followed by a non .. path element\n    // (cannot be . because normPath is used prior to this RegExp)\n    + '(?:[^./][^/]*|\\\\.{2,}(?:[^./][^/]*)|\\\\.{3,}[^/]*)'\n    // followed by .. followed by a path break.\n    + '/\\\\.\\\\.(?:/|$)');\n\nvar PARENT_DIRECTORY_HANDLER_RE = new RegExp(PARENT_DIRECTORY_HANDLER);\n\nvar EXTRA_PARENT_PATHS_RE = /^(?:\\.\\.\\/)*(?:\\.\\.$)?/;\n\n/**\n * Normalizes its input path and collapses all . and .. sequences except for\n * .. sequences that would take it above the root of the current parent\n * directory.\n * {@updoc\n *  $ collapse_dots('foo/../bar')\n *  # 'bar'\n *  $ collapse_dots('foo/./bar')\n *  # 'foo/bar'\n *  $ collapse_dots('foo/../bar/./../../baz')\n *  # 'baz'\n *  $ collapse_dots('../foo')\n *  # '../foo'\n *  $ collapse_dots('../foo').replace(EXTRA_PARENT_PATHS_RE, '')\n *  # 'foo'\n * }\n */\nfunction collapse_dots(path) {\n  if (path === null) { return null; }\n  var p = normPath(path);\n  // Only /../ left to flatten\n  var r = PARENT_DIRECTORY_HANDLER_RE;\n  // We replace with $1 which matches a / before the .. because this\n  // guarantees that:\n  // (1) we have at most 1 / between the adjacent place,\n  // (2) always have a slash if there is a preceding path section, and\n  // (3) we never turn a relative path into an absolute path.\n  for (var q; (q = p.replace(r, '$1')) != p; p = q) {};\n  return p;\n}\n\n/**\n * resolves a relative url string to a base uri.\n * @return {URI}\n */\nfunction resolve(baseUri, relativeUri) {\n  // there are several kinds of relative urls:\n  // 1. //foo - replaces everything from the domain on.  foo is a domain name\n  // 2. foo - replaces the last part of the path, the whole query and fragment\n  // 3. /foo - replaces the the path, the query and fragment\n  // 4. ?foo - replace the query and fragment\n  // 5. #foo - replace the fragment only\n\n  var absoluteUri = baseUri.clone();\n  // we satisfy these conditions by looking for the first part of relativeUri\n  // that is not blank and applying defaults to the rest\n\n  var overridden = relativeUri.hasScheme();\n\n  if (overridden) {\n    absoluteUri.setRawScheme(relativeUri.getRawScheme());\n  } else {\n    overridden = relativeUri.hasCredentials();\n  }\n\n  if (overridden) {\n    absoluteUri.setRawCredentials(relativeUri.getRawCredentials());\n  } else {\n    overridden = relativeUri.hasDomain();\n  }\n\n  if (overridden) {\n    absoluteUri.setRawDomain(relativeUri.getRawDomain());\n  } else {\n    overridden = relativeUri.hasPort();\n  }\n\n  var rawPath = relativeUri.getRawPath();\n  var simplifiedPath = collapse_dots(rawPath);\n  if (overridden) {\n    absoluteUri.setPort(relativeUri.getPort());\n    simplifiedPath = simplifiedPath\n        && simplifiedPath.replace(EXTRA_PARENT_PATHS_RE, '');\n  } else {\n    overridden = !!rawPath;\n    if (overridden) {\n      // resolve path properly\n      if (simplifiedPath.charCodeAt(0) !== 0x2f /* / */) {  // path is relative\n        var absRawPath = collapse_dots(absoluteUri.getRawPath() || '')\n            .replace(EXTRA_PARENT_PATHS_RE, '');\n        var slash = absRawPath.lastIndexOf('/') + 1;\n        simplifiedPath = collapse_dots(\n            (slash ? absRawPath.substring(0, slash) : '')\n            + collapse_dots(rawPath))\n            .replace(EXTRA_PARENT_PATHS_RE, '');\n      }\n    } else {\n      simplifiedPath = simplifiedPath\n          && simplifiedPath.replace(EXTRA_PARENT_PATHS_RE, '');\n      if (simplifiedPath !== rawPath) {\n        absoluteUri.setRawPath(simplifiedPath);\n      }\n    }\n  }\n\n  if (overridden) {\n    absoluteUri.setRawPath(simplifiedPath);\n  } else {\n    overridden = relativeUri.hasQuery();\n  }\n\n  if (overridden) {\n    absoluteUri.setRawQuery(relativeUri.getRawQuery());\n  } else {\n    overridden = relativeUri.hasFragment();\n  }\n\n  if (overridden) {\n    absoluteUri.setRawFragment(relativeUri.getRawFragment());\n  }\n\n  return absoluteUri;\n}\n\n/**\n * a mutable URI.\n *\n * This class contains setters and getters for the parts of the URI.\n * The <tt>getXYZ</tt>/<tt>setXYZ</tt> methods return the decoded part -- so\n * <code>uri.parse('/foo%20bar').getPath()</code> will return the decoded path,\n * <tt>/foo bar</tt>.\n *\n * <p>The raw versions of fields are available too.\n * <code>uri.parse('/foo%20bar').getRawPath()</code> will return the raw path,\n * <tt>/foo%20bar</tt>.  Use the raw setters with care, since\n * <code>URI::toString</code> is not guaranteed to return a valid url if a\n * raw setter was used.\n *\n * <p>All setters return <tt>this</tt> and so may be chained, a la\n * <code>uri.parse('/foo').setFragment('part').toString()</code>.\n *\n * <p>You should not use this constructor directly -- please prefer the factory\n * functions {@link uri.parse}, {@link uri.create}, {@link uri.resolve}\n * instead.</p>\n *\n * <p>The parameters are all raw (assumed to be properly escaped) parts, and\n * any (but not all) may be null.  Undefined is not allowed.</p>\n *\n * @constructor\n */\nfunction URI(\n    rawScheme,\n    rawCredentials, rawDomain, port,\n    rawPath, rawQuery, rawFragment) {\n  this.scheme_ = rawScheme;\n  this.credentials_ = rawCredentials;\n  this.domain_ = rawDomain;\n  this.port_ = port;\n  this.path_ = rawPath;\n  this.query_ = rawQuery;\n  this.fragment_ = rawFragment;\n  /**\n   * @type {Array|null}\n   */\n  this.paramCache_ = null;\n}\n\n/** returns the string form of the url. */\nURI.prototype.toString = function () {\n  var out = [];\n  if (null !== this.scheme_) { out.push(this.scheme_, ':'); }\n  if (null !== this.domain_) {\n    out.push('//');\n    if (null !== this.credentials_) { out.push(this.credentials_, '@'); }\n    out.push(this.domain_);\n    if (null !== this.port_) { out.push(':', this.port_.toString()); }\n  }\n  if (null !== this.path_) { out.push(this.path_); }\n  if (null !== this.query_) { out.push('?', this.query_); }\n  if (null !== this.fragment_) { out.push('#', this.fragment_); }\n  return out.join('');\n};\n\nURI.prototype.clone = function () {\n  return new URI(this.scheme_, this.credentials_, this.domain_, this.port_,\n                 this.path_, this.query_, this.fragment_);\n};\n\nURI.prototype.getScheme = function () {\n  // HTML5 spec does not require the scheme to be lowercased but\n  // all common browsers except Safari lowercase the scheme.\n  return this.scheme_ && decodeURIComponent(this.scheme_).toLowerCase();\n};\nURI.prototype.getRawScheme = function () {\n  return this.scheme_;\n};\nURI.prototype.setScheme = function (newScheme) {\n  this.scheme_ = encodeIfExists2(\n      newScheme, URI_DISALLOWED_IN_SCHEME_OR_CREDENTIALS_);\n  return this;\n};\nURI.prototype.setRawScheme = function (newScheme) {\n  this.scheme_ = newScheme ? newScheme : null;\n  return this;\n};\nURI.prototype.hasScheme = function () {\n  return null !== this.scheme_;\n};\n\n\nURI.prototype.getCredentials = function () {\n  return this.credentials_ && decodeURIComponent(this.credentials_);\n};\nURI.prototype.getRawCredentials = function () {\n  return this.credentials_;\n};\nURI.prototype.setCredentials = function (newCredentials) {\n  this.credentials_ = encodeIfExists2(\n      newCredentials, URI_DISALLOWED_IN_SCHEME_OR_CREDENTIALS_);\n\n  return this;\n};\nURI.prototype.setRawCredentials = function (newCredentials) {\n  this.credentials_ = newCredentials ? newCredentials : null;\n  return this;\n};\nURI.prototype.hasCredentials = function () {\n  return null !== this.credentials_;\n};\n\n\nURI.prototype.getDomain = function () {\n  return this.domain_ && decodeURIComponent(this.domain_);\n};\nURI.prototype.getRawDomain = function () {\n  return this.domain_;\n};\nURI.prototype.setDomain = function (newDomain) {\n  return this.setRawDomain(newDomain && encodeURIComponent(newDomain));\n};\nURI.prototype.setRawDomain = function (newDomain) {\n  this.domain_ = newDomain ? newDomain : null;\n  // Maintain the invariant that paths must start with a slash when the URI\n  // is not path-relative.\n  return this.setRawPath(this.path_);\n};\nURI.prototype.hasDomain = function () {\n  return null !== this.domain_;\n};\n\n\nURI.prototype.getPort = function () {\n  return this.port_ && decodeURIComponent(this.port_);\n};\nURI.prototype.setPort = function (newPort) {\n  if (newPort) {\n    newPort = Number(newPort);\n    if (newPort !== (newPort & 0xffff)) {\n      throw new Error('Bad port number ' + newPort);\n    }\n    this.port_ = '' + newPort;\n  } else {\n    this.port_ = null;\n  }\n  return this;\n};\nURI.prototype.hasPort = function () {\n  return null !== this.port_;\n};\n\n\nURI.prototype.getPath = function () {\n  return this.path_ && decodeURIComponent(this.path_);\n};\nURI.prototype.getRawPath = function () {\n  return this.path_;\n};\nURI.prototype.setPath = function (newPath) {\n  return this.setRawPath(encodeIfExists2(newPath, URI_DISALLOWED_IN_PATH_));\n};\nURI.prototype.setRawPath = function (newPath) {\n  if (newPath) {\n    newPath = String(newPath);\n    this.path_ = \n      // Paths must start with '/' unless this is a path-relative URL.\n      (!this.domain_ || /^\\//.test(newPath)) ? newPath : '/' + newPath;\n  } else {\n    this.path_ = null;\n  }\n  return this;\n};\nURI.prototype.hasPath = function () {\n  return null !== this.path_;\n};\n\n\nURI.prototype.getQuery = function () {\n  // From http://www.w3.org/Addressing/URL/4_URI_Recommentations.html\n  // Within the query string, the plus sign is reserved as shorthand notation\n  // for a space.\n  return this.query_ && decodeURIComponent(this.query_).replace(/\\+/g, ' ');\n};\nURI.prototype.getRawQuery = function () {\n  return this.query_;\n};\nURI.prototype.setQuery = function (newQuery) {\n  this.paramCache_ = null;\n  this.query_ = encodeIfExists(newQuery);\n  return this;\n};\nURI.prototype.setRawQuery = function (newQuery) {\n  this.paramCache_ = null;\n  this.query_ = newQuery ? newQuery : null;\n  return this;\n};\nURI.prototype.hasQuery = function () {\n  return null !== this.query_;\n};\n\n/**\n * sets the query given a list of strings of the form\n * [ key0, value0, key1, value1, ... ].\n *\n * <p><code>uri.setAllParameters(['a', 'b', 'c', 'd']).getQuery()</code>\n * will yield <code>'a=b&c=d'</code>.\n */\nURI.prototype.setAllParameters = function (params) {\n  if (typeof params === 'object') {\n    if (!(params instanceof Array)\n        && (params instanceof Object\n            || Object.prototype.toString.call(params) !== '[object Array]')) {\n      var newParams = [];\n      var i = -1;\n      for (var k in params) {\n        var v = params[k];\n        if ('string' === typeof v) {\n          newParams[++i] = k;\n          newParams[++i] = v;\n        }\n      }\n      params = newParams;\n    }\n  }\n  this.paramCache_ = null;\n  var queryBuf = [];\n  var separator = '';\n  for (var j = 0; j < params.length;) {\n    var k = params[j++];\n    var v = params[j++];\n    queryBuf.push(separator, encodeURIComponent(k.toString()));\n    separator = '&';\n    if (v) {\n      queryBuf.push('=', encodeURIComponent(v.toString()));\n    }\n  }\n  this.query_ = queryBuf.join('');\n  return this;\n};\nURI.prototype.checkParameterCache_ = function () {\n  if (!this.paramCache_) {\n    var q = this.query_;\n    if (!q) {\n      this.paramCache_ = [];\n    } else {\n      var cgiParams = q.split(/[&\\?]/);\n      var out = [];\n      var k = -1;\n      for (var i = 0; i < cgiParams.length; ++i) {\n        var m = cgiParams[i].match(/^([^=]*)(?:=(.*))?$/);\n        // From http://www.w3.org/Addressing/URL/4_URI_Recommentations.html\n        // Within the query string, the plus sign is reserved as shorthand\n        // notation for a space.\n        out[++k] = decodeURIComponent(m[1]).replace(/\\+/g, ' ');\n        out[++k] = decodeURIComponent(m[2] || '').replace(/\\+/g, ' ');\n      }\n      this.paramCache_ = out;\n    }\n  }\n};\n/**\n * sets the values of the named cgi parameters.\n *\n * <p>So, <code>uri.parse('foo?a=b&c=d&e=f').setParameterValues('c', ['new'])\n * </code> yields <tt>foo?a=b&c=new&e=f</tt>.</p>\n *\n * @param key {string}\n * @param values {Array.<string>} the new values.  If values is a single string\n *   then it will be treated as the sole value.\n */\nURI.prototype.setParameterValues = function (key, values) {\n  // be nice and avoid subtle bugs where [] operator on string performs charAt\n  // on some browsers and crashes on IE\n  if (typeof values === 'string') {\n    values = [ values ];\n  }\n\n  this.checkParameterCache_();\n  var newValueIndex = 0;\n  var pc = this.paramCache_;\n  var params = [];\n  for (var i = 0, k = 0; i < pc.length; i += 2) {\n    if (key === pc[i]) {\n      if (newValueIndex < values.length) {\n        params.push(key, values[newValueIndex++]);\n      }\n    } else {\n      params.push(pc[i], pc[i + 1]);\n    }\n  }\n  while (newValueIndex < values.length) {\n    params.push(key, values[newValueIndex++]);\n  }\n  this.setAllParameters(params);\n  return this;\n};\nURI.prototype.removeParameter = function (key) {\n  return this.setParameterValues(key, []);\n};\n/**\n * returns the parameters specified in the query part of the uri as a list of\n * keys and values like [ key0, value0, key1, value1, ... ].\n *\n * @return {Array.<string>}\n */\nURI.prototype.getAllParameters = function () {\n  this.checkParameterCache_();\n  return this.paramCache_.slice(0, this.paramCache_.length);\n};\n/**\n * returns the value<b>s</b> for a given cgi parameter as a list of decoded\n * query parameter values.\n * @return {Array.<string>}\n */\nURI.prototype.getParameterValues = function (paramNameUnescaped) {\n  this.checkParameterCache_();\n  var values = [];\n  for (var i = 0; i < this.paramCache_.length; i += 2) {\n    if (paramNameUnescaped === this.paramCache_[i]) {\n      values.push(this.paramCache_[i + 1]);\n    }\n  }\n  return values;\n};\n/**\n * returns a map of cgi parameter names to (non-empty) lists of values.\n * @return {Object.<string,Array.<string>>}\n */\nURI.prototype.getParameterMap = function (paramNameUnescaped) {\n  this.checkParameterCache_();\n  var paramMap = {};\n  for (var i = 0; i < this.paramCache_.length; i += 2) {\n    var key = this.paramCache_[i++],\n      value = this.paramCache_[i++];\n    if (!(key in paramMap)) {\n      paramMap[key] = [value];\n    } else {\n      paramMap[key].push(value);\n    }\n  }\n  return paramMap;\n};\n/**\n * returns the first value for a given cgi parameter or null if the given\n * parameter name does not appear in the query string.\n * If the given parameter name does appear, but has no '<tt>=</tt>' following\n * it, then the empty string will be returned.\n * @return {string|null}\n */\nURI.prototype.getParameterValue = function (paramNameUnescaped) {\n  this.checkParameterCache_();\n  for (var i = 0; i < this.paramCache_.length; i += 2) {\n    if (paramNameUnescaped === this.paramCache_[i]) {\n      return this.paramCache_[i + 1];\n    }\n  }\n  return null;\n};\n\nURI.prototype.getFragment = function () {\n  return this.fragment_ && decodeURIComponent(this.fragment_);\n};\nURI.prototype.getRawFragment = function () {\n  return this.fragment_;\n};\nURI.prototype.setFragment = function (newFragment) {\n  this.fragment_ = newFragment ? encodeURIComponent(newFragment) : null;\n  return this;\n};\nURI.prototype.setRawFragment = function (newFragment) {\n  this.fragment_ = newFragment ? newFragment : null;\n  return this;\n};\nURI.prototype.hasFragment = function () {\n  return null !== this.fragment_;\n};\n\nfunction nullIfAbsent(matchPart) {\n  return ('string' == typeof matchPart) && (matchPart.length > 0)\n         ? matchPart\n         : null;\n}\n\n\n\n\n/**\n * a regular expression for breaking a URI into its component parts.\n *\n * <p>http://www.gbiv.com/protocols/uri/rfc/rfc3986.html#RFC2234 says\n * As the \"first-match-wins\" algorithm is identical to the \"greedy\"\n * disambiguation method used by POSIX regular expressions, it is natural and\n * commonplace to use a regular expression for parsing the potential five\n * components of a URI reference.\n *\n * <p>The following line is the regular expression for breaking-down a\n * well-formed URI reference into its components.\n *\n * <pre>\n * ^(([^:/?#]+):)?(//([^/?#]*))?([^?#]*)(\\?([^#]*))?(#(.*))?\n *  12            3  4          5       6  7        8 9\n * </pre>\n *\n * <p>The numbers in the second line above are only to assist readability; they\n * indicate the reference points for each subexpression (i.e., each paired\n * parenthesis). We refer to the value matched for subexpression <n> as $<n>.\n * For example, matching the above expression to\n * <pre>\n *     http://www.ics.uci.edu/pub/ietf/uri/#Related\n * </pre>\n * results in the following subexpression matches:\n * <pre>\n *    $1 = http:\n *    $2 = http\n *    $3 = //www.ics.uci.edu\n *    $4 = www.ics.uci.edu\n *    $5 = /pub/ietf/uri/\n *    $6 = <undefined>\n *    $7 = <undefined>\n *    $8 = #Related\n *    $9 = Related\n * </pre>\n * where <undefined> indicates that the component is not present, as is the\n * case for the query component in the above example. Therefore, we can\n * determine the value of the five components as\n * <pre>\n *    scheme    = $2\n *    authority = $4\n *    path      = $5\n *    query     = $7\n *    fragment  = $9\n * </pre>\n *\n * <p>msamuel: I have modified the regular expression slightly to expose the\n * credentials, domain, and port separately from the authority.\n * The modified version yields\n * <pre>\n *    $1 = http              scheme\n *    $2 = <undefined>       credentials -\\\n *    $3 = www.ics.uci.edu   domain       | authority\n *    $4 = <undefined>       port        -/\n *    $5 = /pub/ietf/uri/    path\n *    $6 = <undefined>       query without ?\n *    $7 = Related           fragment without #\n * </pre>\n */\nvar URI_RE_ = new RegExp(\n      \"^\" +\n      \"(?:\" +\n        \"([^:/?#]+)\" +         // scheme\n      \":)?\" +\n      \"(?://\" +\n        \"(?:([^/?#]*)@)?\" +    // credentials\n        \"([^/?#:@]*)\" +        // domain\n        \"(?::([0-9]+))?\" +     // port\n      \")?\" +\n      \"([^?#]+)?\" +            // path\n      \"(?:\\\\?([^#]*))?\" +      // query\n      \"(?:#(.*))?\" +           // fragment\n      \"$\"\n      );\n\nvar URI_DISALLOWED_IN_SCHEME_OR_CREDENTIALS_ = /[#\\/\\?@]/g;\nvar URI_DISALLOWED_IN_PATH_ = /[\\#\\?]/g;\n\nURI.parse = parse;\nURI.create = create;\nURI.resolve = resolve;\nURI.collapse_dots = collapse_dots;  // Visible for testing.\n\n// lightweight string-based api for loadModuleMaker\nURI.utils = {\n  mimeTypeOf: function (uri) {\n    var uriObj = parse(uri);\n    if (/\\.html$/.test(uriObj.getPath())) {\n      return 'text/html';\n    } else {\n      return 'application/javascript';\n    }\n  },\n  resolve: function (base, uri) {\n    if (base) {\n      return resolve(parse(base), parse(uri)).toString();\n    } else {\n      return '' + uri;\n    }\n  }\n};\n\n\nreturn URI;\n})();\n\n// Copyright Google Inc.\n// Licensed under the Apache Licence Version 2.0\n// Autogenerated at Mon Feb 25 13:05:42 EST 2013\n// @overrides window\n// @provides html4\nvar html4 = {};\nhtml4.atype = {\n  'NONE': 0,\n  'URI': 1,\n  'URI_FRAGMENT': 11,\n  'SCRIPT': 2,\n  'STYLE': 3,\n  'HTML': 12,\n  'ID': 4,\n  'IDREF': 5,\n  'IDREFS': 6,\n  'GLOBAL_NAME': 7,\n  'LOCAL_NAME': 8,\n  'CLASSES': 9,\n  'FRAME_TARGET': 10,\n  'MEDIA_QUERY': 13\n};\nhtml4[ 'atype' ] = html4.atype;\nhtml4.ATTRIBS = {\n  '*::class': 9,\n  '*::dir': 0,\n  '*::draggable': 0,\n  '*::hidden': 0,\n  '*::id': 4,\n  '*::inert': 0,\n  '*::itemprop': 0,\n  '*::itemref': 6,\n  '*::itemscope': 0,\n  '*::lang': 0,\n  '*::onblur': 2,\n  '*::onchange': 2,\n  '*::onclick': 2,\n  '*::ondblclick': 2,\n  '*::onfocus': 2,\n  '*::onkeydown': 2,\n  '*::onkeypress': 2,\n  '*::onkeyup': 2,\n  '*::onload': 2,\n  '*::onmousedown': 2,\n  '*::onmousemove': 2,\n  '*::onmouseout': 2,\n  '*::onmouseover': 2,\n  '*::onmouseup': 2,\n  '*::onreset': 2,\n  '*::onscroll': 2,\n  '*::onselect': 2,\n  '*::onsubmit': 2,\n  '*::onunload': 2,\n  '*::spellcheck': 0,\n  '*::style': 3,\n  '*::title': 0,\n  '*::translate': 0,\n  'a::accesskey': 0,\n  'a::coords': 0,\n  'a::href': 1,\n  'a::hreflang': 0,\n  'a::name': 7,\n  'a::onblur': 2,\n  'a::onfocus': 2,\n  'a::shape': 0,\n  'a::tabindex': 0,\n  'a::target': 10,\n  'a::type': 0,\n  'area::accesskey': 0,\n  'area::alt': 0,\n  'area::coords': 0,\n  'area::href': 1,\n  'area::nohref': 0,\n  'area::onblur': 2,\n  'area::onfocus': 2,\n  'area::shape': 0,\n  'area::tabindex': 0,\n  'area::target': 10,\n  'audio::controls': 0,\n  'audio::loop': 0,\n  'audio::mediagroup': 5,\n  'audio::muted': 0,\n  'audio::preload': 0,\n  'bdo::dir': 0,\n  'blockquote::cite': 1,\n  'br::clear': 0,\n  'button::accesskey': 0,\n  'button::disabled': 0,\n  'button::name': 8,\n  'button::onblur': 2,\n  'button::onfocus': 2,\n  'button::tabindex': 0,\n  'button::type': 0,\n  'button::value': 0,\n  'canvas::height': 0,\n  'canvas::width': 0,\n  'caption::align': 0,\n  'col::align': 0,\n  'col::char': 0,\n  'col::charoff': 0,\n  'col::span': 0,\n  'col::valign': 0,\n  'col::width': 0,\n  'colgroup::align': 0,\n  'colgroup::char': 0,\n  'colgroup::charoff': 0,\n  'colgroup::span': 0,\n  'colgroup::valign': 0,\n  'colgroup::width': 0,\n  'command::checked': 0,\n  'command::command': 5,\n  'command::disabled': 0,\n  'command::icon': 1,\n  'command::label': 0,\n  'command::radiogroup': 0,\n  'command::type': 0,\n  'data::value': 0,\n  'del::cite': 1,\n  'del::datetime': 0,\n  'details::open': 0,\n  'dir::compact': 0,\n  'div::align': 0,\n  'dl::compact': 0,\n  'fieldset::disabled': 0,\n  'font::color': 0,\n  'font::face': 0,\n  'font::size': 0,\n  'form::accept': 0,\n  'form::action': 1,\n  'form::autocomplete': 0,\n  'form::enctype': 0,\n  'form::method': 0,\n  'form::name': 7,\n  'form::novalidate': 0,\n  'form::onreset': 2,\n  'form::onsubmit': 2,\n  'form::target': 10,\n  'h1::align': 0,\n  'h2::align': 0,\n  'h3::align': 0,\n  'h4::align': 0,\n  'h5::align': 0,\n  'h6::align': 0,\n  'hr::align': 0,\n  'hr::noshade': 0,\n  'hr::size': 0,\n  'hr::width': 0,\n  'iframe::align': 0,\n  'iframe::frameborder': 0,\n  'iframe::height': 0,\n  'iframe::marginheight': 0,\n  'iframe::marginwidth': 0,\n  'iframe::width': 0,\n  'img::align': 0,\n  'img::alt': 0,\n  'img::border': 0,\n  'img::height': 0,\n  'img::hspace': 0,\n  'img::ismap': 0,\n  'img::name': 7,\n  'img::src': 1,\n  'img::usemap': 11,\n  'img::vspace': 0,\n  'img::width': 0,\n  'input::accept': 0,\n  'input::accesskey': 0,\n  'input::align': 0,\n  'input::alt': 0,\n  'input::autocomplete': 0,\n  'input::checked': 0,\n  'input::disabled': 0,\n  'input::inputmode': 0,\n  'input::ismap': 0,\n  'input::list': 5,\n  'input::max': 0,\n  'input::maxlength': 0,\n  'input::min': 0,\n  'input::multiple': 0,\n  'input::name': 8,\n  'input::onblur': 2,\n  'input::onchange': 2,\n  'input::onfocus': 2,\n  'input::onselect': 2,\n  'input::placeholder': 0,\n  'input::readonly': 0,\n  'input::required': 0,\n  'input::size': 0,\n  'input::src': 1,\n  'input::step': 0,\n  'input::tabindex': 0,\n  'input::type': 0,\n  'input::usemap': 11,\n  'input::value': 0,\n  'ins::cite': 1,\n  'ins::datetime': 0,\n  'label::accesskey': 0,\n  'label::for': 5,\n  'label::onblur': 2,\n  'label::onfocus': 2,\n  'legend::accesskey': 0,\n  'legend::align': 0,\n  'li::type': 0,\n  'li::value': 0,\n  'map::name': 7,\n  'menu::compact': 0,\n  'menu::label': 0,\n  'menu::type': 0,\n  'meter::high': 0,\n  'meter::low': 0,\n  'meter::max': 0,\n  'meter::min': 0,\n  'meter::value': 0,\n  'ol::compact': 0,\n  'ol::reversed': 0,\n  'ol::start': 0,\n  'ol::type': 0,\n  'optgroup::disabled': 0,\n  'optgroup::label': 0,\n  'option::disabled': 0,\n  'option::label': 0,\n  'option::selected': 0,\n  'option::value': 0,\n  'output::for': 6,\n  'output::name': 8,\n  'p::align': 0,\n  'pre::width': 0,\n  'progress::max': 0,\n  'progress::min': 0,\n  'progress::value': 0,\n  'q::cite': 1,\n  'select::autocomplete': 0,\n  'select::disabled': 0,\n  'select::multiple': 0,\n  'select::name': 8,\n  'select::onblur': 2,\n  'select::onchange': 2,\n  'select::onfocus': 2,\n  'select::required': 0,\n  'select::size': 0,\n  'select::tabindex': 0,\n  'source::type': 0,\n  'table::align': 0,\n  'table::bgcolor': 0,\n  'table::border': 0,\n  'table::cellpadding': 0,\n  'table::cellspacing': 0,\n  'table::frame': 0,\n  'table::rules': 0,\n  'table::summary': 0,\n  'table::width': 0,\n  'tbody::align': 0,\n  'tbody::char': 0,\n  'tbody::charoff': 0,\n  'tbody::valign': 0,\n  'td::abbr': 0,\n  'td::align': 0,\n  'td::axis': 0,\n  'td::bgcolor': 0,\n  'td::char': 0,\n  'td::charoff': 0,\n  'td::colspan': 0,\n  'td::headers': 6,\n  'td::height': 0,\n  'td::nowrap': 0,\n  'td::rowspan': 0,\n  'td::scope': 0,\n  'td::valign': 0,\n  'td::width': 0,\n  'textarea::accesskey': 0,\n  'textarea::autocomplete': 0,\n  'textarea::cols': 0,\n  'textarea::disabled': 0,\n  'textarea::inputmode': 0,\n  'textarea::name': 8,\n  'textarea::onblur': 2,\n  'textarea::onchange': 2,\n  'textarea::onfocus': 2,\n  'textarea::onselect': 2,\n  'textarea::placeholder': 0,\n  'textarea::readonly': 0,\n  'textarea::required': 0,\n  'textarea::rows': 0,\n  'textarea::tabindex': 0,\n  'textarea::wrap': 0,\n  'tfoot::align': 0,\n  'tfoot::char': 0,\n  'tfoot::charoff': 0,\n  'tfoot::valign': 0,\n  'th::abbr': 0,\n  'th::align': 0,\n  'th::axis': 0,\n  'th::bgcolor': 0,\n  'th::char': 0,\n  'th::charoff': 0,\n  'th::colspan': 0,\n  'th::headers': 6,\n  'th::height': 0,\n  'th::nowrap': 0,\n  'th::rowspan': 0,\n  'th::scope': 0,\n  'th::valign': 0,\n  'th::width': 0,\n  'thead::align': 0,\n  'thead::char': 0,\n  'thead::charoff': 0,\n  'thead::valign': 0,\n  'tr::align': 0,\n  'tr::bgcolor': 0,\n  'tr::char': 0,\n  'tr::charoff': 0,\n  'tr::valign': 0,\n  'track::default': 0,\n  'track::kind': 0,\n  'track::label': 0,\n  'track::srclang': 0,\n  'ul::compact': 0,\n  'ul::type': 0,\n  'video::controls': 0,\n  'video::height': 0,\n  'video::loop': 0,\n  'video::mediagroup': 5,\n  'video::muted': 0,\n  'video::poster': 1,\n  'video::preload': 0,\n  'video::width': 0\n};\nhtml4[ 'ATTRIBS' ] = html4.ATTRIBS;\nhtml4.eflags = {\n  'OPTIONAL_ENDTAG': 1,\n  'EMPTY': 2,\n  'CDATA': 4,\n  'RCDATA': 8,\n  'UNSAFE': 16,\n  'FOLDABLE': 32,\n  'SCRIPT': 64,\n  'STYLE': 128,\n  'VIRTUALIZED': 256\n};\nhtml4[ 'eflags' ] = html4.eflags;\nhtml4.ELEMENTS = {\n  'a': 0,\n  'abbr': 0,\n  'acronym': 0,\n  'address': 0,\n  'applet': 272,\n  'area': 2,\n  'article': 0,\n  'aside': 0,\n  'audio': 0,\n  'b': 0,\n  'base': 274,\n  'basefont': 274,\n  'bdi': 0,\n  'bdo': 0,\n  'big': 0,\n  'blockquote': 0,\n  'body': 305,\n  'br': 2,\n  'button': 0,\n  'canvas': 0,\n  'caption': 0,\n  'center': 0,\n  'cite': 0,\n  'code': 0,\n  'col': 2,\n  'colgroup': 1,\n  'command': 2,\n  'data': 0,\n  'datalist': 0,\n  'dd': 1,\n  'del': 0,\n  'details': 0,\n  'dfn': 0,\n  'dialog': 272,\n  'dir': 0,\n  'div': 0,\n  'dl': 0,\n  'dt': 1,\n  'em': 0,\n  'fieldset': 0,\n  'figcaption': 0,\n  'figure': 0,\n  'font': 0,\n  'footer': 0,\n  'form': 0,\n  'frame': 274,\n  'frameset': 272,\n  'h1': 0,\n  'h2': 0,\n  'h3': 0,\n  'h4': 0,\n  'h5': 0,\n  'h6': 0,\n  'head': 305,\n  'header': 0,\n  'hgroup': 0,\n  'hr': 2,\n  'html': 305,\n  'i': 0,\n  'iframe': 4,\n  'img': 2,\n  'input': 2,\n  'ins': 0,\n  'isindex': 274,\n  'kbd': 0,\n  'keygen': 274,\n  'label': 0,\n  'legend': 0,\n  'li': 1,\n  'link': 274,\n  'map': 0,\n  'mark': 0,\n  'menu': 0,\n  'meta': 274,\n  'meter': 0,\n  'nav': 0,\n  'nobr': 0,\n  'noembed': 276,\n  'noframes': 276,\n  'noscript': 276,\n  'object': 272,\n  'ol': 0,\n  'optgroup': 0,\n  'option': 1,\n  'output': 0,\n  'p': 1,\n  'param': 274,\n  'pre': 0,\n  'progress': 0,\n  'q': 0,\n  's': 0,\n  'samp': 0,\n  'script': 84,\n  'section': 0,\n  'select': 0,\n  'small': 0,\n  'source': 2,\n  'span': 0,\n  'strike': 0,\n  'strong': 0,\n  'style': 148,\n  'sub': 0,\n  'summary': 0,\n  'sup': 0,\n  'table': 0,\n  'tbody': 1,\n  'td': 1,\n  'textarea': 8,\n  'tfoot': 1,\n  'th': 1,\n  'thead': 1,\n  'time': 0,\n  'title': 280,\n  'tr': 1,\n  'track': 2,\n  'tt': 0,\n  'u': 0,\n  'ul': 0,\n  'var': 0,\n  'video': 0,\n  'wbr': 2\n};\nhtml4[ 'ELEMENTS' ] = html4.ELEMENTS;\nhtml4.ELEMENT_DOM_INTERFACES = {\n  'a': 'HTMLAnchorElement',\n  'abbr': 'HTMLElement',\n  'acronym': 'HTMLElement',\n  'address': 'HTMLElement',\n  'applet': 'HTMLAppletElement',\n  'area': 'HTMLAreaElement',\n  'article': 'HTMLElement',\n  'aside': 'HTMLElement',\n  'audio': 'HTMLAudioElement',\n  'b': 'HTMLElement',\n  'base': 'HTMLBaseElement',\n  'basefont': 'HTMLBaseFontElement',\n  'bdi': 'HTMLElement',\n  'bdo': 'HTMLElement',\n  'big': 'HTMLElement',\n  'blockquote': 'HTMLQuoteElement',\n  'body': 'HTMLBodyElement',\n  'br': 'HTMLBRElement',\n  'button': 'HTMLButtonElement',\n  'canvas': 'HTMLCanvasElement',\n  'caption': 'HTMLTableCaptionElement',\n  'center': 'HTMLElement',\n  'cite': 'HTMLElement',\n  'code': 'HTMLElement',\n  'col': 'HTMLTableColElement',\n  'colgroup': 'HTMLTableColElement',\n  'command': 'HTMLCommandElement',\n  'data': 'HTMLElement',\n  'datalist': 'HTMLDataListElement',\n  'dd': 'HTMLElement',\n  'del': 'HTMLModElement',\n  'details': 'HTMLDetailsElement',\n  'dfn': 'HTMLElement',\n  'dialog': 'HTMLDialogElement',\n  'dir': 'HTMLDirectoryElement',\n  'div': 'HTMLDivElement',\n  'dl': 'HTMLDListElement',\n  'dt': 'HTMLElement',\n  'em': 'HTMLElement',\n  'fieldset': 'HTMLFieldSetElement',\n  'figcaption': 'HTMLElement',\n  'figure': 'HTMLElement',\n  'font': 'HTMLFontElement',\n  'footer': 'HTMLElement',\n  'form': 'HTMLFormElement',\n  'frame': 'HTMLFrameElement',\n  'frameset': 'HTMLFrameSetElement',\n  'h1': 'HTMLHeadingElement',\n  'h2': 'HTMLHeadingElement',\n  'h3': 'HTMLHeadingElement',\n  'h4': 'HTMLHeadingElement',\n  'h5': 'HTMLHeadingElement',\n  'h6': 'HTMLHeadingElement',\n  'head': 'HTMLHeadElement',\n  'header': 'HTMLElement',\n  'hgroup': 'HTMLElement',\n  'hr': 'HTMLHRElement',\n  'html': 'HTMLHtmlElement',\n  'i': 'HTMLElement',\n  'iframe': 'HTMLIFrameElement',\n  'img': 'HTMLImageElement',\n  'input': 'HTMLInputElement',\n  'ins': 'HTMLModElement',\n  'isindex': 'HTMLUnknownElement',\n  'kbd': 'HTMLElement',\n  'keygen': 'HTMLKeygenElement',\n  'label': 'HTMLLabelElement',\n  'legend': 'HTMLLegendElement',\n  'li': 'HTMLLIElement',\n  'link': 'HTMLLinkElement',\n  'map': 'HTMLMapElement',\n  'mark': 'HTMLElement',\n  'menu': 'HTMLMenuElement',\n  'meta': 'HTMLMetaElement',\n  'meter': 'HTMLMeterElement',\n  'nav': 'HTMLElement',\n  'nobr': 'HTMLElement',\n  'noembed': 'HTMLElement',\n  'noframes': 'HTMLElement',\n  'noscript': 'HTMLElement',\n  'object': 'HTMLObjectElement',\n  'ol': 'HTMLOListElement',\n  'optgroup': 'HTMLOptGroupElement',\n  'option': 'HTMLOptionElement',\n  'output': 'HTMLOutputElement',\n  'p': 'HTMLParagraphElement',\n  'param': 'HTMLParamElement',\n  'pre': 'HTMLPreElement',\n  'progress': 'HTMLProgressElement',\n  'q': 'HTMLQuoteElement',\n  's': 'HTMLElement',\n  'samp': 'HTMLElement',\n  'script': 'HTMLScriptElement',\n  'section': 'HTMLElement',\n  'select': 'HTMLSelectElement',\n  'small': 'HTMLElement',\n  'source': 'HTMLSourceElement',\n  'span': 'HTMLSpanElement',\n  'strike': 'HTMLElement',\n  'strong': 'HTMLElement',\n  'style': 'HTMLStyleElement',\n  'sub': 'HTMLElement',\n  'summary': 'HTMLElement',\n  'sup': 'HTMLElement',\n  'table': 'HTMLTableElement',\n  'tbody': 'HTMLTableSectionElement',\n  'td': 'HTMLTableDataCellElement',\n  'textarea': 'HTMLTextAreaElement',\n  'tfoot': 'HTMLTableSectionElement',\n  'th': 'HTMLTableHeaderCellElement',\n  'thead': 'HTMLTableSectionElement',\n  'time': 'HTMLTimeElement',\n  'title': 'HTMLTitleElement',\n  'tr': 'HTMLTableRowElement',\n  'track': 'HTMLTrackElement',\n  'tt': 'HTMLElement',\n  'u': 'HTMLElement',\n  'ul': 'HTMLUListElement',\n  'var': 'HTMLElement',\n  'video': 'HTMLVideoElement',\n  'wbr': 'HTMLElement'\n};\nhtml4[ 'ELEMENT_DOM_INTERFACES' ] = html4.ELEMENT_DOM_INTERFACES;\nhtml4.ueffects = {\n  'NOT_LOADED': 0,\n  'SAME_DOCUMENT': 1,\n  'NEW_DOCUMENT': 2\n};\nhtml4[ 'ueffects' ] = html4.ueffects;\nhtml4.URIEFFECTS = {\n  'a::href': 2,\n  'area::href': 2,\n  'blockquote::cite': 0,\n  'command::icon': 1,\n  'del::cite': 0,\n  'form::action': 2,\n  'img::src': 1,\n  'input::src': 1,\n  'ins::cite': 0,\n  'q::cite': 0,\n  'video::poster': 1\n};\nhtml4[ 'URIEFFECTS' ] = html4.URIEFFECTS;\nhtml4.ltypes = {\n  'UNSANDBOXED': 2,\n  'SANDBOXED': 1,\n  'DATA': 0\n};\nhtml4[ 'ltypes' ] = html4.ltypes;\nhtml4.LOADERTYPES = {\n  'a::href': 2,\n  'area::href': 2,\n  'blockquote::cite': 2,\n  'command::icon': 1,\n  'del::cite': 2,\n  'form::action': 2,\n  'img::src': 1,\n  'input::src': 1,\n  'ins::cite': 2,\n  'q::cite': 2,\n  'video::poster': 1\n};\nhtml4[ 'LOADERTYPES' ] = html4.LOADERTYPES;\n\n// Copyright (C) 2006 Google Inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//      http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\n/**\n * @fileoverview\n * An HTML sanitizer that can satisfy a variety of security policies.\n *\n * <p>\n * The HTML sanitizer is built around a SAX parser and HTML element and\n * attributes schemas.\n *\n * If the cssparser is loaded, inline styles are sanitized using the\n * css property and value schemas.  Else they are remove during\n * sanitization.\n *\n * If it exists, uses parseCssDeclarations, sanitizeCssProperty,  cssSchema\n *\n * @author mikesamuel@gmail.com\n * @author jasvir@gmail.com\n * \\@requires html4, URI\n * \\@overrides window\n * \\@provides html, html_sanitize\n */\n\n// The Turkish i seems to be a non-issue, but abort in case it is.\nif ('I'.toLowerCase() !== 'i') { throw 'I/i problem'; }\n\n/**\n * \\@namespace\n */\nvar html = (function(html4) {\n\n  // For closure compiler\n  var parseCssDeclarations, sanitizeCssProperty, cssSchema;\n  if ('undefined' !== typeof window) {\n    parseCssDeclarations = window['parseCssDeclarations'];\n    sanitizeCssProperty = window['sanitizeCssProperty'];\n    cssSchema = window['cssSchema'];\n  }\n\n  // The keys of this object must be 'quoted' or JSCompiler will mangle them!\n  // This is a partial list -- lookupEntity() uses the host browser's parser\n  // (when available) to implement full entity lookup.\n  // Note that entities are in general case-sensitive; the uppercase ones are\n  // explicitly defined by HTML5 (presumably as compatibility).\n  var ENTITIES = {\n    'lt': '<',\n    'LT': '<',\n    'gt': '>',\n    'GT': '>',\n    'amp': '&',\n    'AMP': '&',\n    'quot': '\"',\n    'apos': '\\'',\n    'nbsp': '\\240'\n  };\n\n  // Patterns for types of entity/character reference names.\n  var decimalEscapeRe = /^#(\\d+)$/;\n  var hexEscapeRe = /^#x([0-9A-Fa-f]+)$/;\n  // contains every entity per http://www.w3.org/TR/2011/WD-html5-20110113/named-character-references.html\n  var safeEntityNameRe = /^[A-Za-z][A-za-z0-9]+$/;\n  // Used as a hook to invoke the browser's entity parsing. <textarea> is used\n  // because its content is parsed for entities but not tags.\n  // TODO(kpreid): This retrieval is a kludge and leads to silent loss of\n  // functionality if the document isn't available.\n  var entityLookupElement =\n      ('undefined' !== typeof window && window['document'])\n          ? window['document'].createElement('textarea') : null;\n  /**\n   * Decodes an HTML entity.\n   *\n   * {\\@updoc\n   * $ lookupEntity('lt')\n   * # '<'\n   * $ lookupEntity('GT')\n   * # '>'\n   * $ lookupEntity('amp')\n   * # '&'\n   * $ lookupEntity('nbsp')\n   * # '\\xA0'\n   * $ lookupEntity('apos')\n   * # \"'\"\n   * $ lookupEntity('quot')\n   * # '\"'\n   * $ lookupEntity('#xa')\n   * # '\\n'\n   * $ lookupEntity('#10')\n   * # '\\n'\n   * $ lookupEntity('#x0a')\n   * # '\\n'\n   * $ lookupEntity('#010')\n   * # '\\n'\n   * $ lookupEntity('#x00A')\n   * # '\\n'\n   * $ lookupEntity('Pi')      // Known failure\n   * # '\\u03A0'\n   * $ lookupEntity('pi')      // Known failure\n   * # '\\u03C0'\n   * }\n   *\n   * @param {string} name the content between the '&' and the ';'.\n   * @return {string} a single unicode code-point as a string.\n   */\n  function lookupEntity(name) {\n    // TODO: entity lookup as specified by HTML5 actually depends on the\n    // presence of the \";\".\n    if (ENTITIES.hasOwnProperty(name)) { return ENTITIES[name]; }\n    var m = name.match(decimalEscapeRe);\n    if (m) {\n      return String.fromCharCode(parseInt(m[1], 10));\n    } else if (!!(m = name.match(hexEscapeRe))) {\n      return String.fromCharCode(parseInt(m[1], 16));\n    } else if (entityLookupElement && safeEntityNameRe.test(name)) {\n      entityLookupElement.innerHTML = '&' + name + ';';\n      var text = entityLookupElement.textContent;\n      ENTITIES[name] = text;\n      return text;\n    } else {\n      return '&' + name + ';';\n    }\n  }\n\n  function decodeOneEntity(_, name) {\n    return lookupEntity(name);\n  }\n\n  var nulRe = /\\0/g;\n  function stripNULs(s) {\n    return s.replace(nulRe, '');\n  }\n\n  var ENTITY_RE_1 = /&(#[0-9]+|#[xX][0-9A-Fa-f]+|\\w+);/g;\n  var ENTITY_RE_2 = /^(#[0-9]+|#[xX][0-9A-Fa-f]+|\\w+);/;\n  /**\n   * The plain text of a chunk of HTML CDATA which possibly containing.\n   *\n   * {\\@updoc\n   * $ unescapeEntities('')\n   * # ''\n   * $ unescapeEntities('hello World!')\n   * # 'hello World!'\n   * $ unescapeEntities('1 &lt; 2 &amp;&AMP; 4 &gt; 3&#10;')\n   * # '1 < 2 && 4 > 3\\n'\n   * $ unescapeEntities('&lt;&lt <- unfinished entity&gt;')\n   * # '<&lt <- unfinished entity>'\n   * $ unescapeEntities('/foo?bar=baz&copy=true')  // & often unescaped in URLS\n   * # '/foo?bar=baz&copy=true'\n   * $ unescapeEntities('pi=&pi;&#x3c0;, Pi=&Pi;\\u03A0') // FIXME: known failure\n   * # 'pi=\\u03C0\\u03c0, Pi=\\u03A0\\u03A0'\n   * }\n   *\n   * @param {string} s a chunk of HTML CDATA.  It must not start or end inside\n   *     an HTML entity.\n   */\n  function unescapeEntities(s) {\n    return s.replace(ENTITY_RE_1, decodeOneEntity);\n  }\n\n  var ampRe = /&/g;\n  var looseAmpRe = /&([^a-z#]|#(?:[^0-9x]|x(?:[^0-9a-f]|$)|$)|$)/gi;\n  var ltRe = /[<]/g;\n  var gtRe = />/g;\n  var quotRe = /\\\"/g;\n\n  /**\n   * Escapes HTML special characters in attribute values.\n   *\n   * {\\@updoc\n   * $ escapeAttrib('')\n   * # ''\n   * $ escapeAttrib('\"<<&==&>>\"')  // Do not just escape the first occurrence.\n   * # '&#34;&lt;&lt;&amp;&#61;&#61;&amp;&gt;&gt;&#34;'\n   * $ escapeAttrib('Hello <World>!')\n   * # 'Hello &lt;World&gt;!'\n   * }\n   */\n  function escapeAttrib(s) {\n    return ('' + s).replace(ampRe, '&amp;').replace(ltRe, '&lt;')\n        .replace(gtRe, '&gt;').replace(quotRe, '&#34;');\n  }\n\n  /**\n   * Escape entities in RCDATA that can be escaped without changing the meaning.\n   * {\\@updoc\n   * $ normalizeRCData('1 < 2 &&amp; 3 > 4 &amp;& 5 &lt; 7&8')\n   * # '1 &lt; 2 &amp;&amp; 3 &gt; 4 &amp;&amp; 5 &lt; 7&amp;8'\n   * }\n   */\n  function normalizeRCData(rcdata) {\n    return rcdata\n        .replace(looseAmpRe, '&amp;$1')\n        .replace(ltRe, '&lt;')\n        .replace(gtRe, '&gt;');\n  }\n\n  // TODO(felix8a): validate sanitizer regexs against the HTML5 grammar at\n  // http://www.whatwg.org/specs/web-apps/current-work/multipage/syntax.html\n  // http://www.whatwg.org/specs/web-apps/current-work/multipage/parsing.html\n  // http://www.whatwg.org/specs/web-apps/current-work/multipage/tokenization.html\n  // http://www.whatwg.org/specs/web-apps/current-work/multipage/tree-construction.html\n\n  // We initially split input so that potentially meaningful characters\n  // like '<' and '>' are separate tokens, using a fast dumb process that\n  // ignores quoting.  Then we walk that token stream, and when we see a\n  // '<' that's the start of a tag, we use ATTR_RE to extract tag\n  // attributes from the next token.  That token will never have a '>'\n  // character.  However, it might have an unbalanced quote character, and\n  // when we see that, we combine additional tokens to balance the quote.\n\n  var ATTR_RE = new RegExp(\n    '^\\\\s*' +\n    '([-.:\\\\w]+)' +             // 1 = Attribute name\n    '(?:' + (\n      '\\\\s*(=)\\\\s*' +           // 2 = Is there a value?\n      '(' + (                   // 3 = Attribute value\n        // TODO(felix8a): maybe use backref to match quotes\n        '(\\\")[^\\\"]*(\\\"|$)' +    // 4, 5 = Double-quoted string\n        '|' +\n        '(\\')[^\\']*(\\'|$)' +    // 6, 7 = Single-quoted string\n        '|' +\n        // Positive lookahead to prevent interpretation of\n        // <foo a= b=c> as <foo a='b=c'>\n        // TODO(felix8a): might be able to drop this case\n        '(?=[a-z][-\\\\w]*\\\\s*=)' +\n        '|' +\n        // Unquoted value that isn't an attribute name\n        // (since we didn't match the positive lookahead above)\n        '[^\\\"\\'\\\\s]*' ) +\n      ')' ) +\n    ')?',\n    'i');\n\n  // false on IE<=8, true on most other browsers\n  var splitWillCapture = ('a,b'.split(/(,)/).length === 3);\n\n  // bitmask for tags with special parsing, like <script> and <textarea>\n  var EFLAGS_TEXT = html4.eflags['CDATA'] | html4.eflags['RCDATA'];\n\n  /**\n   * Given a SAX-like event handler, produce a function that feeds those\n   * events and a parameter to the event handler.\n   *\n   * The event handler has the form:{@code\n   * {\n   *   // Name is an upper-case HTML tag name.  Attribs is an array of\n   *   // alternating upper-case attribute names, and attribute values.  The\n   *   // attribs array is reused by the parser.  Param is the value passed to\n   *   // the saxParser.\n   *   startTag: function (name, attribs, param) { ... },\n   *   endTag:   function (name, param) { ... },\n   *   pcdata:   function (text, param) { ... },\n   *   rcdata:   function (text, param) { ... },\n   *   cdata:    function (text, param) { ... },\n   *   startDoc: function (param) { ... },\n   *   endDoc:   function (param) { ... }\n   * }}\n   *\n   * @param {Object} handler a record containing event handlers.\n   * @return {function(string, Object)} A function that takes a chunk of HTML\n   *     and a parameter.  The parameter is passed on to the handler methods.\n   */\n  function makeSaxParser(handler) {\n    // Accept quoted or unquoted keys (Closure compat)\n    var hcopy = {\n      cdata: handler.cdata || handler['cdata'],\n      comment: handler.comment || handler['comment'],\n      endDoc: handler.endDoc || handler['endDoc'],\n      endTag: handler.endTag || handler['endTag'],\n      pcdata: handler.pcdata || handler['pcdata'],\n      rcdata: handler.rcdata || handler['rcdata'],\n      startDoc: handler.startDoc || handler['startDoc'],\n      startTag: handler.startTag || handler['startTag']\n    };\n    return function(htmlText, param) {\n      return parse(htmlText, hcopy, param);\n    };\n  }\n\n  // Parsing strategy is to split input into parts that might be lexically\n  // meaningful (every \">\" becomes a separate part), and then recombine\n  // parts if we discover they're in a different context.\n\n  // TODO(felix8a): Significant performance regressions from -legacy,\n  // tested on\n  //    Chrome 18.0\n  //    Firefox 11.0\n  //    IE 6, 7, 8, 9\n  //    Opera 11.61\n  //    Safari 5.1.3\n  // Many of these are unusual patterns that are linearly slower and still\n  // pretty fast (eg 1ms to 5ms), so not necessarily worth fixing.\n\n  // TODO(felix8a): \"<script> && && && ... <\\/script>\" is slower on all\n  // browsers.  The hotspot is htmlSplit.\n\n  // TODO(felix8a): \"<p title='>>>>...'><\\/p>\" is slower on all browsers.\n  // This is partly htmlSplit, but the hotspot is parseTagAndAttrs.\n\n  // TODO(felix8a): \"<a><\\/a><a><\\/a>...\" is slower on IE9.\n  // \"<a>1<\\/a><a>1<\\/a>...\" is faster, \"<a><\\/a>2<a><\\/a>2...\" is faster.\n\n  // TODO(felix8a): \"<p<p<p...\" is slower on IE[6-8]\n\n  var continuationMarker = {};\n  function parse(htmlText, handler, param) {\n    var m, p, tagName;\n    var parts = htmlSplit(htmlText);\n    var state = {\n      noMoreGT: false,\n      noMoreEndComments: false\n    };\n    parseCPS(handler, parts, 0, state, param);\n  }\n\n  function continuationMaker(h, parts, initial, state, param) {\n    return function () {\n      parseCPS(h, parts, initial, state, param);\n    };\n  }\n\n  function parseCPS(h, parts, initial, state, param) {\n    try {\n      if (h.startDoc && initial == 0) { h.startDoc(param); }\n      var m, p, tagName;\n      for (var pos = initial, end = parts.length; pos < end;) {\n        var current = parts[pos++];\n        var next = parts[pos];\n        switch (current) {\n        case '&':\n          if (ENTITY_RE_2.test(next)) {\n            if (h.pcdata) {\n              h.pcdata('&' + next, param, continuationMarker,\n                continuationMaker(h, parts, pos, state, param));\n            }\n            pos++;\n          } else {\n            if (h.pcdata) { h.pcdata(\"&amp;\", param, continuationMarker,\n                continuationMaker(h, parts, pos, state, param));\n            }\n          }\n          break;\n        case '<\\/':\n          if (m = /^([-\\w:]+)[^\\'\\\"]*/.exec(next)) {\n            if (m[0].length === next.length && parts[pos + 1] === '>') {\n              // fast case, no attribute parsing needed\n              pos += 2;\n              tagName = m[1].toLowerCase();\n              if (h.endTag) {\n                h.endTag(tagName, param, continuationMarker,\n                  continuationMaker(h, parts, pos, state, param));\n              }\n            } else {\n              // slow case, need to parse attributes\n              // TODO(felix8a): do we really care about misparsing this?\n              pos = parseEndTag(\n                parts, pos, h, param, continuationMarker, state);\n            }\n          } else {\n            if (h.pcdata) {\n              h.pcdata('&lt;/', param, continuationMarker,\n                continuationMaker(h, parts, pos, state, param));\n            }\n          }\n          break;\n        case '<':\n          if (m = /^([-\\w:]+)\\s*\\/?/.exec(next)) {\n            if (m[0].length === next.length && parts[pos + 1] === '>') {\n              // fast case, no attribute parsing needed\n              pos += 2;\n              tagName = m[1].toLowerCase();\n              if (h.startTag) {\n                h.startTag(tagName, [], param, continuationMarker,\n                  continuationMaker(h, parts, pos, state, param));\n              }\n              // tags like <script> and <textarea> have special parsing\n              var eflags = html4.ELEMENTS[tagName];\n              if (eflags & EFLAGS_TEXT) {\n                var tag = { name: tagName, next: pos, eflags: eflags };\n                pos = parseText(\n                  parts, tag, h, param, continuationMarker, state);\n              }\n            } else {\n              // slow case, need to parse attributes\n              pos = parseStartTag(\n                parts, pos, h, param, continuationMarker, state);\n            }\n          } else {\n            if (h.pcdata) {\n              h.pcdata('&lt;', param, continuationMarker,\n                continuationMaker(h, parts, pos, state, param));\n            }\n          }\n          break;\n        case '<\\!--':\n          // The pathological case is n copies of '<\\!--' without '-->', and\n          // repeated failure to find '-->' is quadratic.  We avoid that by\n          // remembering when search for '-->' fails.\n          if (!state.noMoreEndComments) {\n            // A comment <\\!--x--> is split into three tokens:\n            //   '<\\!--', 'x--', '>'\n            // We want to find the next '>' token that has a preceding '--'.\n            // pos is at the 'x--'.\n            for (p = pos + 1; p < end; p++) {\n              if (parts[p] === '>' && /--$/.test(parts[p - 1])) { break; }\n            }\n            if (p < end) {\n              if (h.comment) {\n                var comment = parts.slice(pos, p).join('');\n                h.comment(\n                  comment.substr(0, comment.length - 2), param,\n                  continuationMarker,\n                  continuationMaker(h, parts, p + 1, state, param));\n              }\n              pos = p + 1;\n            } else {\n              state.noMoreEndComments = true;\n            }\n          }\n          if (state.noMoreEndComments) {\n            if (h.pcdata) {\n              h.pcdata('&lt;!--', param, continuationMarker,\n                continuationMaker(h, parts, pos, state, param));\n            }\n          }\n          break;\n        case '<\\!':\n          if (!/^\\w/.test(next)) {\n            if (h.pcdata) {\n              h.pcdata('&lt;!', param, continuationMarker,\n                continuationMaker(h, parts, pos, state, param));\n            }\n          } else {\n            // similar to noMoreEndComment logic\n            if (!state.noMoreGT) {\n              for (p = pos + 1; p < end; p++) {\n                if (parts[p] === '>') { break; }\n              }\n              if (p < end) {\n                pos = p + 1;\n              } else {\n                state.noMoreGT = true;\n              }\n            }\n            if (state.noMoreGT) {\n              if (h.pcdata) {\n                h.pcdata('&lt;!', param, continuationMarker,\n                  continuationMaker(h, parts, pos, state, param));\n              }\n            }\n          }\n          break;\n        case '<?':\n          // similar to noMoreEndComment logic\n          if (!state.noMoreGT) {\n            for (p = pos + 1; p < end; p++) {\n              if (parts[p] === '>') { break; }\n            }\n            if (p < end) {\n              pos = p + 1;\n            } else {\n              state.noMoreGT = true;\n            }\n          }\n          if (state.noMoreGT) {\n            if (h.pcdata) {\n              h.pcdata('&lt;?', param, continuationMarker,\n                continuationMaker(h, parts, pos, state, param));\n            }\n          }\n          break;\n        case '>':\n          if (h.pcdata) {\n            h.pcdata(\"&gt;\", param, continuationMarker,\n              continuationMaker(h, parts, pos, state, param));\n          }\n          break;\n        case '':\n          break;\n        default:\n          if (h.pcdata) {\n            h.pcdata(current, param, continuationMarker,\n              continuationMaker(h, parts, pos, state, param));\n          }\n          break;\n        }\n      }\n      if (h.endDoc) { h.endDoc(param); }\n    } catch (e) {\n      if (e !== continuationMarker) { throw e; }\n    }\n  }\n\n  // Split str into parts for the html parser.\n  function htmlSplit(str) {\n    // can't hoist this out of the function because of the re.exec loop.\n    var re = /(<\\/|<\\!--|<[!?]|[&<>])/g;\n    str += '';\n    if (splitWillCapture) {\n      return str.split(re);\n    } else {\n      var parts = [];\n      var lastPos = 0;\n      var m;\n      while ((m = re.exec(str)) !== null) {\n        parts.push(str.substring(lastPos, m.index));\n        parts.push(m[0]);\n        lastPos = m.index + m[0].length;\n      }\n      parts.push(str.substring(lastPos));\n      return parts;\n    }\n  }\n\n  function parseEndTag(parts, pos, h, param, continuationMarker, state) {\n    var tag = parseTagAndAttrs(parts, pos);\n    // drop unclosed tags\n    if (!tag) { return parts.length; }\n    if (h.endTag) {\n      h.endTag(tag.name, param, continuationMarker,\n        continuationMaker(h, parts, pos, state, param));\n    }\n    return tag.next;\n  }\n\n  function parseStartTag(parts, pos, h, param, continuationMarker, state) {\n    var tag = parseTagAndAttrs(parts, pos);\n    // drop unclosed tags\n    if (!tag) { return parts.length; }\n    if (h.startTag) {\n      h.startTag(tag.name, tag.attrs, param, continuationMarker,\n        continuationMaker(h, parts, tag.next, state, param));\n    }\n    // tags like <script> and <textarea> have special parsing\n    if (tag.eflags & EFLAGS_TEXT) {\n      return parseText(parts, tag, h, param, continuationMarker, state);\n    } else {\n      return tag.next;\n    }\n  }\n\n  var endTagRe = {};\n\n  // Tags like <script> and <textarea> are flagged as CDATA or RCDATA,\n  // which means everything is text until we see the correct closing tag.\n  function parseText(parts, tag, h, param, continuationMarker, state) {\n    var end = parts.length;\n    if (!endTagRe.hasOwnProperty(tag.name)) {\n      endTagRe[tag.name] = new RegExp('^' + tag.name + '(?:[\\\\s\\\\/]|$)', 'i');\n    }\n    var re = endTagRe[tag.name];\n    var first = tag.next;\n    var p = tag.next + 1;\n    for (; p < end; p++) {\n      if (parts[p - 1] === '<\\/' && re.test(parts[p])) { break; }\n    }\n    if (p < end) { p -= 1; }\n    var buf = parts.slice(first, p).join('');\n    if (tag.eflags & html4.eflags['CDATA']) {\n      if (h.cdata) {\n        h.cdata(buf, param, continuationMarker,\n          continuationMaker(h, parts, p, state, param));\n      }\n    } else if (tag.eflags & html4.eflags['RCDATA']) {\n      if (h.rcdata) {\n        h.rcdata(normalizeRCData(buf), param, continuationMarker,\n          continuationMaker(h, parts, p, state, param));\n      }\n    } else {\n      throw new Error('bug');\n    }\n    return p;\n  }\n\n  // at this point, parts[pos-1] is either \"<\" or \"<\\/\".\n  function parseTagAndAttrs(parts, pos) {\n    var m = /^([-\\w:]+)/.exec(parts[pos]);\n    var tag = {};\n    tag.name = m[1].toLowerCase();\n    tag.eflags = html4.ELEMENTS[tag.name];\n    var buf = parts[pos].substr(m[0].length);\n    // Find the next '>'.  We optimistically assume this '>' is not in a\n    // quoted context, and further down we fix things up if it turns out to\n    // be quoted.\n    var p = pos + 1;\n    var end = parts.length;\n    for (; p < end; p++) {\n      if (parts[p] === '>') { break; }\n      buf += parts[p];\n    }\n    if (end <= p) { return void 0; }\n    var attrs = [];\n    while (buf !== '') {\n      m = ATTR_RE.exec(buf);\n      if (!m) {\n        // No attribute found: skip garbage\n        buf = buf.replace(/^[\\s\\S][^a-z\\s]*/, '');\n\n      } else if ((m[4] && !m[5]) || (m[6] && !m[7])) {\n        // Unterminated quote: slurp to the next unquoted '>'\n        var quote = m[4] || m[6];\n        var sawQuote = false;\n        var abuf = [buf, parts[p++]];\n        for (; p < end; p++) {\n          if (sawQuote) {\n            if (parts[p] === '>') { break; }\n          } else if (0 <= parts[p].indexOf(quote)) {\n            sawQuote = true;\n          }\n          abuf.push(parts[p]);\n        }\n        // Slurp failed: lose the garbage\n        if (end <= p) { break; }\n        // Otherwise retry attribute parsing\n        buf = abuf.join('');\n        continue;\n\n      } else {\n        // We have an attribute\n        var aName = m[1].toLowerCase();\n        var aValue = m[2] ? decodeValue(m[3]) : '';\n        attrs.push(aName, aValue);\n        buf = buf.substr(m[0].length);\n      }\n    }\n    tag.attrs = attrs;\n    tag.next = p + 1;\n    return tag;\n  }\n\n  function decodeValue(v) {\n    var q = v.charCodeAt(0);\n    if (q === 0x22 || q === 0x27) { // \" or '\n      v = v.substr(1, v.length - 2);\n    }\n    return unescapeEntities(stripNULs(v));\n  }\n\n  /**\n   * Returns a function that strips unsafe tags and attributes from html.\n   * @param {function(string, Array.<string>): ?Array.<string>} tagPolicy\n   *     A function that takes (tagName, attribs[]), where tagName is a key in\n   *     html4.ELEMENTS and attribs is an array of alternating attribute names\n   *     and values.  It should return a record (as follows), or null to delete\n   *     the element.  It's okay for tagPolicy to modify the attribs array,\n   *     but the same array is reused, so it should not be held between calls.\n   *     Record keys:\n   *        attribs: (required) Sanitized attributes array.\n   *        tagName: Replacement tag name.\n   * @return {function(string, Array)} A function that sanitizes a string of\n   *     HTML and appends result strings to the second argument, an array.\n   */\n  function makeHtmlSanitizer(tagPolicy) {\n    var stack;\n    var ignoring;\n    var emit = function (text, out) {\n      if (!ignoring) { out.push(text); }\n    };\n    return makeSaxParser({\n      'startDoc': function(_) {\n        stack = [];\n        ignoring = false;\n      },\n      'startTag': function(tagNameOrig, attribs, out) {\n        if (ignoring) { return; }\n        if (!html4.ELEMENTS.hasOwnProperty(tagNameOrig)) { return; }\n        var eflagsOrig = html4.ELEMENTS[tagNameOrig];\n        if (eflagsOrig & html4.eflags['FOLDABLE']) {\n          return;\n        }\n\n        var decision = tagPolicy(tagNameOrig, attribs);\n        if (!decision) {\n          ignoring = !(eflagsOrig & html4.eflags['EMPTY']);\n          return;\n        } else if (typeof decision !== 'object') {\n          throw new Error('tagPolicy did not return object (old API?)');\n        }\n        if ('attribs' in decision) {\n          attribs = decision['attribs'];\n        } else {\n          throw new Error('tagPolicy gave no attribs');\n        }\n        var eflagsRep;\n        var tagNameRep;\n        if ('tagName' in decision) {\n          tagNameRep = decision['tagName'];\n          eflagsRep = html4.ELEMENTS[tagNameRep];\n        } else {\n          tagNameRep = tagNameOrig;\n          eflagsRep = eflagsOrig;\n        }\n        // TODO(mikesamuel): relying on tagPolicy not to insert unsafe\n        // attribute names.\n\n        // If this is an optional-end-tag element and either this element or its\n        // previous like sibling was rewritten, then insert a close tag to\n        // preserve structure.\n        if (eflagsOrig & html4.eflags['OPTIONAL_ENDTAG']) {\n          var onStack = stack[stack.length - 1];\n          if (onStack && onStack.orig === tagNameOrig &&\n              (onStack.rep !== tagNameRep || tagNameOrig !== tagNameRep)) {\n                out.push('<\\/', onStack.rep, '>');\n          }\n        }\n\n        if (!(eflagsOrig & html4.eflags['EMPTY'])) {\n          stack.push({orig: tagNameOrig, rep: tagNameRep});\n        }\n\n        out.push('<', tagNameRep);\n        for (var i = 0, n = attribs.length; i < n; i += 2) {\n          var attribName = attribs[i],\n              value = attribs[i + 1];\n          if (value !== null && value !== void 0) {\n            out.push(' ', attribName, '=\"', escapeAttrib(value), '\"');\n          }\n        }\n        out.push('>');\n\n        if ((eflagsOrig & html4.eflags['EMPTY'])\n            && !(eflagsRep & html4.eflags['EMPTY'])) {\n          // replacement is non-empty, synthesize end tag\n          out.push('<\\/', tagNameRep, '>');\n        }\n      },\n      'endTag': function(tagName, out) {\n        if (ignoring) {\n          ignoring = false;\n          return;\n        }\n        if (!html4.ELEMENTS.hasOwnProperty(tagName)) { return; }\n        var eflags = html4.ELEMENTS[tagName];\n        if (!(eflags & (html4.eflags['EMPTY'] | html4.eflags['FOLDABLE']))) {\n          var index;\n          if (eflags & html4.eflags['OPTIONAL_ENDTAG']) {\n            for (index = stack.length; --index >= 0;) {\n              var stackElOrigTag = stack[index].orig;\n              if (stackElOrigTag === tagName) { break; }\n              if (!(html4.ELEMENTS[stackElOrigTag] &\n                    html4.eflags['OPTIONAL_ENDTAG'])) {\n                // Don't pop non optional end tags looking for a match.\n                return;\n              }\n            }\n          } else {\n            for (index = stack.length; --index >= 0;) {\n              if (stack[index].orig === tagName) { break; }\n            }\n          }\n          if (index < 0) { return; }  // Not opened.\n          for (var i = stack.length; --i > index;) {\n            var stackElRepTag = stack[i].rep;\n            if (!(html4.ELEMENTS[stackElRepTag] &\n                  html4.eflags['OPTIONAL_ENDTAG'])) {\n              out.push('<\\/', stackElRepTag, '>');\n            }\n          }\n          if (index < stack.length) {\n            tagName = stack[index].rep;\n          }\n          stack.length = index;\n          out.push('<\\/', tagName, '>');\n        }\n      },\n      'pcdata': emit,\n      'rcdata': emit,\n      'cdata': emit,\n      'endDoc': function(out) {\n        for (; stack.length; stack.length--) {\n          out.push('<\\/', stack[stack.length - 1].rep, '>');\n        }\n      }\n    });\n  }\n\n  var ALLOWED_URI_SCHEMES = /^(?:https?|mailto|data)$/i;\n\n  function safeUri(uri, effect, ltype, hints, naiveUriRewriter) {\n    if (!naiveUriRewriter) { return null; }\n    try {\n      var parsed = URI.parse('' + uri);\n      if (parsed) {\n        if (!parsed.hasScheme() ||\n            ALLOWED_URI_SCHEMES.test(parsed.getScheme())) {\n          var safe = naiveUriRewriter(parsed, effect, ltype, hints);\n          return safe ? safe.toString() : null;\n        }\n      }\n    } catch (e) {\n      return null;\n    }\n    return null;\n  }\n\n  function log(logger, tagName, attribName, oldValue, newValue) {\n    if (!attribName) {\n      logger(tagName + \" removed\", {\n        change: \"removed\",\n        tagName: tagName\n      });\n    }\n    if (oldValue !== newValue) {\n      var changed = \"changed\";\n      if (oldValue && !newValue) {\n        changed = \"removed\";\n      } else if (!oldValue && newValue)  {\n        changed = \"added\";\n      }\n      logger(tagName + \".\" + attribName + \" \" + changed, {\n        change: changed,\n        tagName: tagName,\n        attribName: attribName,\n        oldValue: oldValue,\n        newValue: newValue\n      });\n    }\n  }\n\n  function lookupAttribute(map, tagName, attribName) {\n    var attribKey;\n    attribKey = tagName + '::' + attribName;\n    if (map.hasOwnProperty(attribKey)) {\n      return map[attribKey];\n    }\n    attribKey = '*::' + attribName;\n    if (map.hasOwnProperty(attribKey)) {\n      return map[attribKey];\n    }\n    return void 0;\n  }\n  function getAttributeType(tagName, attribName) {\n    return lookupAttribute(html4.ATTRIBS, tagName, attribName);\n  }\n  function getLoaderType(tagName, attribName) {\n    return lookupAttribute(html4.LOADERTYPES, tagName, attribName);\n  }\n  function getUriEffect(tagName, attribName) {\n    return lookupAttribute(html4.URIEFFECTS, tagName, attribName);\n  }\n\n  /**\n   * Sanitizes attributes on an HTML tag.\n   * @param {string} tagName An HTML tag name in lowercase.\n   * @param {Array.<?string>} attribs An array of alternating names and values.\n   * @param {?function(?string): ?string} opt_naiveUriRewriter A transform to\n   *     apply to URI attributes; it can return a new string value, or null to\n   *     delete the attribute.  If unspecified, URI attributes are deleted.\n   * @param {function(?string): ?string} opt_nmTokenPolicy A transform to apply\n   *     to attributes containing HTML names, element IDs, and space-separated\n   *     lists of classes; it can return a new string value, or null to delete\n   *     the attribute.  If unspecified, these attributes are kept unchanged.\n   * @return {Array.<?string>} The sanitized attributes as a list of alternating\n   *     names and values, where a null value means to omit the attribute.\n   */\n  function sanitizeAttribs(tagName, attribs,\n    opt_naiveUriRewriter, opt_nmTokenPolicy, opt_logger) {\n    // TODO(felix8a): it's obnoxious that domado duplicates much of this\n    // TODO(felix8a): maybe consistently enforce constraints like target=\n    for (var i = 0; i < attribs.length; i += 2) {\n      var attribName = attribs[i];\n      var value = attribs[i + 1];\n      var oldValue = value;\n      var atype = null, attribKey;\n      if ((attribKey = tagName + '::' + attribName,\n           html4.ATTRIBS.hasOwnProperty(attribKey)) ||\n          (attribKey = '*::' + attribName,\n           html4.ATTRIBS.hasOwnProperty(attribKey))) {\n        atype = html4.ATTRIBS[attribKey];\n      }\n      if (atype !== null) {\n        switch (atype) {\n          case html4.atype['NONE']: break;\n          case html4.atype['SCRIPT']:\n            value = null;\n            if (opt_logger) {\n              log(opt_logger, tagName, attribName, oldValue, value);\n            }\n            break;\n          case html4.atype['STYLE']:\n            if ('undefined' === typeof parseCssDeclarations) {\n              value = null;\n              if (opt_logger) {\n                log(opt_logger, tagName, attribName, oldValue, value);\n\t      }\n              break;\n            }\n            var sanitizedDeclarations = [];\n            parseCssDeclarations(\n                value,\n                {\n                  declaration: function (property, tokens) {\n                    var normProp = property.toLowerCase();\n                    var schema = cssSchema[normProp];\n                    if (!schema) {\n                      return;\n                    }\n                    sanitizeCssProperty(\n                        normProp, schema, tokens,\n                        opt_naiveUriRewriter\n                        ? function (url) {\n                            return safeUri(\n                                url, html4.ueffects.SAME_DOCUMENT,\n                                html4.ltypes.SANDBOXED,\n                                {\n                                  \"TYPE\": \"CSS\",\n                                  \"CSS_PROP\": normProp\n                                }, opt_naiveUriRewriter);\n                          }\n                        : null);\n                    sanitizedDeclarations.push(property + ': ' + tokens.join(' '));\n                  }\n                });\n            value = sanitizedDeclarations.length > 0 ?\n              sanitizedDeclarations.join(' ; ') : null;\n            if (opt_logger) {\n              log(opt_logger, tagName, attribName, oldValue, value);\n            }\n            break;\n          case html4.atype['ID']:\n          case html4.atype['IDREF']:\n          case html4.atype['IDREFS']:\n          case html4.atype['GLOBAL_NAME']:\n          case html4.atype['LOCAL_NAME']:\n          case html4.atype['CLASSES']:\n            value = opt_nmTokenPolicy ? opt_nmTokenPolicy(value) : value;\n            if (opt_logger) {\n              log(opt_logger, tagName, attribName, oldValue, value);\n            }\n            break;\n          case html4.atype['URI']:\n            value = safeUri(value,\n              getUriEffect(tagName, attribName),\n              getLoaderType(tagName, attribName),\n              {\n                \"TYPE\": \"MARKUP\",\n                \"XML_ATTR\": attribName,\n                \"XML_TAG\": tagName\n              }, opt_naiveUriRewriter);\n              if (opt_logger) {\n              log(opt_logger, tagName, attribName, oldValue, value);\n            }\n            break;\n          case html4.atype['URI_FRAGMENT']:\n            if (value && '#' === value.charAt(0)) {\n              value = value.substring(1);  // remove the leading '#'\n              value = opt_nmTokenPolicy ? opt_nmTokenPolicy(value) : value;\n              if (value !== null && value !== void 0) {\n                value = '#' + value;  // restore the leading '#'\n              }\n            } else {\n              value = null;\n            }\n            if (opt_logger) {\n              log(opt_logger, tagName, attribName, oldValue, value);\n            }\n            break;\n          default:\n            value = null;\n            if (opt_logger) {\n              log(opt_logger, tagName, attribName, oldValue, value);\n            }\n            break;\n        }\n      } else {\n        value = null;\n        if (opt_logger) {\n          log(opt_logger, tagName, attribName, oldValue, value);\n        }\n      }\n      attribs[i + 1] = value;\n    }\n    return attribs;\n  }\n\n  /**\n   * Creates a tag policy that omits all tags marked UNSAFE in html4-defs.js\n   * and applies the default attribute sanitizer with the supplied policy for\n   * URI attributes and NMTOKEN attributes.\n   * @param {?function(?string): ?string} opt_naiveUriRewriter A transform to\n   *     apply to URI attributes.  If not given, URI attributes are deleted.\n   * @param {function(?string): ?string} opt_nmTokenPolicy A transform to apply\n   *     to attributes containing HTML names, element IDs, and space-separated\n   *     lists of classes.  If not given, such attributes are left unchanged.\n   * @return {function(string, Array.<?string>)} A tagPolicy suitable for\n   *     passing to html.sanitize.\n   */\n  function makeTagPolicy(\n    opt_naiveUriRewriter, opt_nmTokenPolicy, opt_logger) {\n    return function(tagName, attribs) {\n      if (!(html4.ELEMENTS[tagName] & html4.eflags['UNSAFE'])) {\n        return {\n          'attribs': sanitizeAttribs(tagName, attribs,\n            opt_naiveUriRewriter, opt_nmTokenPolicy, opt_logger)\n        };\n      } else {\n        if (opt_logger) {\n          log(opt_logger, tagName, undefined, undefined, undefined);\n        }\n      }\n    };\n  }\n\n  /**\n   * Sanitizes HTML tags and attributes according to a given policy.\n   * @param {string} inputHtml The HTML to sanitize.\n   * @param {function(string, Array.<?string>)} tagPolicy A function that\n   *     decides which tags to accept and sanitizes their attributes (see\n   *     makeHtmlSanitizer above for details).\n   * @return {string} The sanitized HTML.\n   */\n  function sanitizeWithPolicy(inputHtml, tagPolicy) {\n    var outputArray = [];\n    makeHtmlSanitizer(tagPolicy)(inputHtml, outputArray);\n    return outputArray.join('');\n  }\n\n  /**\n   * Strips unsafe tags and attributes from HTML.\n   * @param {string} inputHtml The HTML to sanitize.\n   * @param {?function(?string): ?string} opt_naiveUriRewriter A transform to\n   *     apply to URI attributes.  If not given, URI attributes are deleted.\n   * @param {function(?string): ?string} opt_nmTokenPolicy A transform to apply\n   *     to attributes containing HTML names, element IDs, and space-separated\n   *     lists of classes.  If not given, such attributes are left unchanged.\n   */\n  function sanitize(inputHtml,\n    opt_naiveUriRewriter, opt_nmTokenPolicy, opt_logger) {\n    var tagPolicy = makeTagPolicy(\n      opt_naiveUriRewriter, opt_nmTokenPolicy, opt_logger);\n    return sanitizeWithPolicy(inputHtml, tagPolicy);\n  }\n\n  // Export both quoted and unquoted names for Closure linkage.\n  var html = {};\n  html.escapeAttrib = html['escapeAttrib'] = escapeAttrib;\n  html.makeHtmlSanitizer = html['makeHtmlSanitizer'] = makeHtmlSanitizer;\n  html.makeSaxParser = html['makeSaxParser'] = makeSaxParser;\n  html.makeTagPolicy = html['makeTagPolicy'] = makeTagPolicy;\n  html.normalizeRCData = html['normalizeRCData'] = normalizeRCData;\n  html.sanitize = html['sanitize'] = sanitize;\n  html.sanitizeAttribs = html['sanitizeAttribs'] = sanitizeAttribs;\n  html.sanitizeWithPolicy = html['sanitizeWithPolicy'] = sanitizeWithPolicy;\n  html.unescapeEntities = html['unescapeEntities'] = unescapeEntities;\n  return html;\n})(html4);\n\nvar html_sanitize = html['sanitize'];\n\n// Loosen restrictions of Caja's\n// html-sanitizer to allow for styling\nhtml4.ATTRIBS['*::style'] = 0;\nhtml4.ELEMENTS['style'] = 0;\nhtml4.ATTRIBS['a::target'] = 0;\nhtml4.ELEMENTS['video'] = 0;\nhtml4.ATTRIBS['video::src'] = 0;\nhtml4.ATTRIBS['video::poster'] = 0;\nhtml4.ATTRIBS['video::controls'] = 0;\nhtml4.ELEMENTS['audio'] = 0;\nhtml4.ATTRIBS['audio::src'] = 0;\nhtml4.ATTRIBS['video::autoplay'] = 0;\nhtml4.ATTRIBS['video::controls'] = 0;\n\nif (typeof module !== 'undefined') {\n    module.exports = html_sanitize;\n}\n","function corslite(url, callback, cors) {\n    var sent = false;\n\n    if (typeof window.XMLHttpRequest === 'undefined') {\n        return callback(Error('Browser not supported'));\n    }\n\n    if (typeof cors === 'undefined') {\n        var m = url.match(/^\\s*https?:\\/\\/[^\\/]*/);\n        cors = m && (m[0] !== location.protocol + '//' + location.domain +\n                (location.port ? ':' + location.port : ''));\n    }\n\n    var x = new window.XMLHttpRequest();\n\n    function isSuccessful(status) {\n        return status >= 200 && status < 300 || status === 304;\n    }\n\n    if (cors && !('withCredentials' in x)) {\n        // IE8-9\n        x = new window.XDomainRequest();\n\n        // Ensure callback is never called synchronously, i.e., before\n        // x.send() returns (this has been observed in the wild).\n        // See https://github.com/mapbox/mapbox.js/issues/472\n        var original = callback;\n        callback = function() {\n            if (sent) {\n                original.apply(this, arguments);\n            } else {\n                var that = this, args = arguments;\n                setTimeout(function() {\n                    original.apply(that, args);\n                }, 0);\n            }\n        }\n    }\n\n    function loaded() {\n        if (\n            // XDomainRequest\n            x.status === undefined ||\n            // modern browsers\n            isSuccessful(x.status)) callback.call(x, null, x);\n        else callback.call(x, x, null);\n    }\n\n    // Both `onreadystatechange` and `onload` can fire. `onreadystatechange`\n    // has [been supported for longer](http://stackoverflow.com/a/9181508/229001).\n    if ('onload' in x) {\n        x.onload = loaded;\n    } else {\n        x.onreadystatechange = function readystate() {\n            if (x.readyState === 4) {\n                loaded();\n            }\n        };\n    }\n\n    // Call the callback with the XMLHttpRequest object as an error and prevent\n    // it from ever being called again by reassigning it to `noop`\n    x.onerror = function error(evt) {\n        // XDomainRequest provides no evt parameter\n        callback.call(this, evt || true, null);\n        callback = function() { };\n    };\n\n    // IE9 must have onprogress be set to a unique function.\n    x.onprogress = function() { };\n\n    x.ontimeout = function(evt) {\n        callback.call(this, evt, null);\n        callback = function() { };\n    };\n\n    x.onabort = function(evt) {\n        callback.call(this, evt, null);\n        callback = function() { };\n    };\n\n    // GET is the only supported HTTP Verb by XDomainRequest and is the\n    // only one supported here.\n    x.open('GET', url, true);\n\n    // Send the request. Sending data is not supported.\n    x.send(null);\n    sent = true;\n\n    return x;\n}\n\nif (typeof module !== 'undefined') module.exports = corslite;\n"]}